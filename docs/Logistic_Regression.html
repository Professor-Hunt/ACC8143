<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>Accounting Data Analytics: Logistic Regression</title>

  <meta property="description" itemprop="description" content="Introduction to logistic regression"/>



  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Accounting Data Analytics: Logistic Regression"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Introduction to logistic regression"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="Accounting Data Analytics"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Accounting Data Analytics: Logistic Regression"/>
  <meta property="twitter:description" content="Introduction to logistic regression"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","output"]}},"value":[{"type":"character","attributes":{},"value":["Logistic Regression"]},{"type":"character","attributes":{},"value":["Introduction to logistic regression\n"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_depth"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[3]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <style type="text/css">
  /* base variables */

  /* Edit the CSS properties in this file to create a custom
     Distill theme. Only edit values in the right column
     for each row; values shown are the CSS defaults.
     To return any property to the default,
     you may set its value to: unset
     All rows must end with a semi-colon.                      */

  /* Optional: embed custom fonts here with `@import`          */
  /* This must remain at the top of this file.                 */



  html {
    /*-- Main font sizes --*/
    --title-size:      50px;
    --body-size:       1.06rem;
    --code-size:       14px;
    --aside-size:      12px;
    --fig-cap-size:    13px;
    /*-- Main font colors --*/
    --title-color:     #000000;
    --header-color:    rgba(0, 0, 0, 0.8);
    --body-color:      rgba(0, 0, 0, 0.8);
    --aside-color:     rgba(0, 0, 0, 0.6);
    --fig-cap-color:   rgba(0, 0, 0, 0.6);
    /*-- Specify custom fonts ~~~ must be imported above   --*/
    --heading-font:    sans-serif;
    --mono-font:       monospace;
    --body-font:       sans-serif;
    --navbar-font:     sans-serif;  /* websites + blogs only */
  }

  /*-- ARTICLE METADATA --*/
  d-byline {
    --heading-size:    0.6rem;
    --heading-color:   rgba(0, 0, 0, 0.5);
    --body-size:       0.8rem;
    --body-color:      rgba(0, 0, 0, 0.8);
  }

  /*-- ARTICLE TABLE OF CONTENTS --*/
  .d-contents {
    --heading-size:    18px;
    --contents-size:   13px;
  }

  /*-- ARTICLE APPENDIX --*/
  d-appendix {
    --heading-size:    15px;
    --heading-color:   rgba(0, 0, 0, 0.65);
    --text-size:       0.8em;
    --text-color:      rgba(0, 0, 0, 0.5);
  }

  /*-- WEBSITE HEADER + FOOTER --*/
  /* These properties only apply to Distill sites and blogs  */

  .distill-site-header {
    --title-size:       18px;
    --text-color:       rgba(255, 255, 255, 0.8);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       #0F2E3D;
  }

  .distill-site-footer {
    --text-color:       rgba(255, 255, 255, 0.8);
    --text-size:        15px;
    --hover-color:      white;
    --bkgd-color:       #0F2E3D;
  }

  /*-- Additional custom styles --*/
  /* Add any additional CSS rules below                      */
  </style>
  <style type="text/css">/* Optional: embed custom fonts here with `@import`          */
  /* This must remain at the top of this file.                 */
  /* @import url('https://fonts.googleapis.com/css2?family=Amiri');   /* 
  /* @import url('https://fonts.googleapis.com/css2?family=Bitter');  /* 
  /* @import url('https://fonts.googleapis.com/css2?family=DM+Mono'); /* 

  /* base variables */

  /* Edit the CSS properties in this file to create a custom
     Distill theme. Only edit values in the right column
     for each row; values shown are the CSS defaults.
     To return any property to the default,
     you may set its value to: unset
     All rows must end with a semi-colon.                      */

  /* Optional: embed custom fonts here with `@import`          */
  /* This must remain at the top of this file.                 */



  html {
    /*-- Main font sizes --*/
    --title-size:      50px;
    --body-size:       1.02rem;
    --code-size:       14px;
    --aside-size:      12px;
    --fig-cap-size:    13px;
    /*-- Main font colors --*/
    --title-color:     #777777;
    --header-color:    rgba(93, 23, 37, 0.8);
    --body-color:      rgba(0, 0, 0, 0.8);
    --aside-color:     rgba(0, 0, 0, 0.8);
    --fig-cap-color:   rgba(189, 214, 230, 0.6);
    /*-- Specify custom fonts ~~~ must be imported above   --*/
    --heading-font:    serif;
    --mono-font:       monospace;
    --body-font:       serif;
    --navbar-font:     serif;
  }

  /*-- ARTICLE METADATA --*/

  d-byline {
    --heading-size:    0.6rem;
    --heading-color:   rgba(93, 23, 37, 0.5);
    --body-size:       0.8rem;
    --body-color:      rgba(193, 198, 200, 0.8);
  }

  /*-- ARTICLE TABLE OF CONTENTS --*/
  .d-contents {
    --heading-size:    18px;
    --contents-size:   13px;
  }

  /*-- ARTICLE APPENDIX --*/

  d-appendix {
    --heading-size:    15px;
    --heading-color:   rgba(93, 23, 37, 0.65);
    --text-size:       0.8em;
    --text-color:      rgba(193, 198, 200, 0.5);
  }

  /*-- WEBSITE HEADER + FOOTER --*/
  /* These properties only apply to Distill sites and blogs  */

  .distill-site-header {
    --title-size:       18px;
    --text-color:       rgba(193, 198, 200, 0.8);
    --text-size:        15px;
    --hover-color:      #777777;
    --bkgd-color:       #5D1725;
  }

  .distill-site-footer {
    --text-color:       rgba(193, 198, 200, 0.8);
    --text-size:        15px;
    --hover-color:      #777777;
    --bkgd-color:       #5D1725;
  }

  /*-- Additional custom styles --*/
  /* Add any additional CSS rules below                      */</style>
  <style type="text/css">
  /* base style */

  /* FONT FAMILIES */

  :root {
    --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  body,
  .posts-list .post-preview p,
  .posts-list .description p {
    font-family: var(--body-font), var(--body-default);
  }

  h1, h2, h3, h4, h5, h6,
  .posts-list .post-preview h2,
  .posts-list .description h2 {
    font-family: var(--heading-font), var(--heading-default);
  }

  d-article div.sourceCode code,
  d-article pre code {
    font-family: var(--mono-font), var(--mono-default);
  }


  /*-- TITLE --*/
  d-title h1,
  .posts-list > h1 {
    color: var(--title-color, black);
  }

  d-title h1 {
    font-size: var(--title-size, 50px);
  }

  /*-- HEADERS --*/
  d-article h1,
  d-article h2,
  d-article h3,
  d-article h4,
  d-article h5,
  d-article h6 {
    color: var(--header-color, rgba(0, 0, 0, 0.8));
  }

  /*-- BODY --*/
  d-article > p,  /* only text inside of <p> tags */
  d-article > ul, /* lists */
  d-article > ol {
    color: var(--body-color, rgba(0, 0, 0, 0.8));
    font-size: var(--body-size, 1.06rem);
  }


  /*-- CODE --*/
  d-article div.sourceCode code,
  d-article pre code {
    font-size: var(--code-size, 14px);
  }

  /*-- ASIDE --*/
  d-article aside {
    font-size: var(--aside-size, 12px);
    color: var(--aside-color, rgba(0, 0, 0, 0.6));
  }

  /*-- FIGURE CAPTIONS --*/
  figure .caption,
  figure figcaption,
  .figure .caption {
    font-size: var(--fig-cap-size, 13px);
    color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
  }

  /*-- METADATA --*/
  d-byline h3 {
    font-size: var(--heading-size, 0.6rem);
    color: var(--heading-color, rgba(0, 0, 0, 0.5));
  }

  d-byline {
    font-size: var(--body-size, 0.8rem);
    color: var(--body-color, rgba(0, 0, 0, 0.8));
  }

  d-byline a,
  d-article d-byline a {
    color: var(--body-color, rgba(0, 0, 0, 0.8));
  }

  /*-- TABLE OF CONTENTS --*/
  .d-contents nav h3 {
    font-size: var(--heading-size, 18px);
  }

  .d-contents nav a {
    font-size: var(--contents-size, 13px);
  }

  /*-- APPENDIX --*/
  d-appendix h3 {
    font-size: var(--heading-size, 15px);
    color: var(--heading-color, rgba(0, 0, 0, 0.65));
  }

  d-appendix {
    font-size: var(--text-size, 0.8em);
    color: var(--text-color, rgba(0, 0, 0, 0.5));
  }

  d-appendix d-footnote-list a.footnote-backlink {
    color: var(--text-color, rgba(0, 0, 0, 0.5));
  }

  /*-- WEBSITE HEADER + FOOTER --*/
  .distill-site-header .title {
    font-size: var(--title-size, 18px);
    font-family: var(--navbar-font), var(--heading-default);
  }

  .distill-site-header a,
  .nav-dropdown .nav-dropbtn {
    font-family: var(--navbar-font), var(--heading-default);
  }

  .nav-dropdown .nav-dropbtn {
    color: var(--text-color, rgba(255, 255, 255, 0.8));
    font-size: var(--text-size, 15px);
  }

  .distill-site-header a:hover,
  .nav-dropdown:hover .nav-dropbtn {
    color: var(--hover-color, white);
  }

  .distill-site-header {
    font-size: var(--text-size, 15px);
    color: var(--text-color, rgba(255, 255, 255, 0.8));
    background-color: var(--bkgd-color, #0F2E3D);
  }

  .distill-site-footer {
    font-size: var(--text-size, 15px);
    color: var(--text-color, rgba(255, 255, 255, 0.8));
    background-color: var(--bkgd-color, #0F2E3D);
  }

  .distill-site-footer a:hover {
    color: var(--hover-color, white);
  }</style>
  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.11/header-attrs.js"></script>
  <script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
  <link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
  <link href="site_libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Logistic Regression","description":"Introduction to logistic regression","authors":[]}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo">
<img src="images/VERTICAL_WEB_white.png" alt="Logo"/>
</a>
<a href="index.html" class="title">Accounting Data Analytics</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="index.html">Home</a>
<a href="about.html">About</a>
<a href="Logic.html">Logic</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Modules
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="RMarkdown.html">RMarkdown</a>
<a href="Wrangling.html">Data Wrangling</a>
<a href="Introduction.html">Introduction</a>
<a href="Hands_on.html">Hands On</a>
<a href="Intro_to_ML.html">Introduction to ML</a>
<a href="Rsquared_Bad.html">Rsquared is Bad</a>
<a href="Dim_Reduction.html">Dimensionality Reduction</a>
<a href="Regression.html">Regression</a>
<a href="KNN.html">K-Nearest Neighbor</a>
<a href="Logistic_Regression.html">Logistic Regression</a>
<a href="Support_Vector_Machine.html">Support Vector Machines</a>
<a href="BaggingRandomForest.html">Bagging and Random Forest</a>
<a href="Gradient_Boosting.html">Gradient Boosting</a>
<a href="Neural_Networks.html">Neural Networks</a>
</div>
</div>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Logistic Regression</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>Introduction to logistic regression</p></p>
</div>


<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#game-plan">Game Plan</a></li>
<li><a href="#formalism">Formalism</a>
<ul>
<li><a href="#logit-function">Logit Function</a></li>
<li><a href="#gradient-descent">Gradient Descent</a>
<ul>
<li><a href="#cost-function">Cost function</a></li>
</ul></li>
</ul></li>
<li><a href="#logistic-modeling">Logistic Modeling</a>
<ul>
<li><a href="#logistic-regression">Logistic Regression</a></li>
</ul></li>
<li><a href="#exercise-1">Exercise 1</a></li>
<li><a href="#sgd-classifier">SGD Classifier</a></li>
<li><a href="#lr-tips-data">LR: Tips Data</a>
<ul>
<li><a href="#numeric">Numeric</a></li>
<li><a href="#categorical-and-numeric">Categorical and Numeric</a>
<ul>
<li><a href="#run-model">Run Model</a></li>
<li><a href="#results">Results</a></li>
<li><a href="#variable-importance">Variable importance</a></li>
<li><a href="#regression-output">Regression Output</a></li>
</ul></li>
</ul></li>
<li><a href="#section"></a>
<ul>
<li><a href="#marginal-effects"><strong>Marginal Effects</strong></a></li>
<li><a href="#odds-ratio"><strong>Odds Ratio</strong></a></li>
</ul></li>
</ul>
</nav>
</div>
<h1 id="game-plan">Game Plan</h1>
<p>In previous sections, we have seen how to perform linear regression on input data to predict a continuous value. In some cases, however, we wish to predict a categorical value, such as True/False or Yes/No.Traditional regression methods are not optimal for these problems, since this requires the prediction of a discrete and not continuous value. In this section we introduce a technique that simulates linear regression, but with an additional function employed that maps the continuous value predicted by linear regression methods into a probability, or specifically the range <code>[0,1]</code>. In this manner, we can apply a threshold to this probability to predict a binary response.</p>
<p>While several functions might be suitable for this transformation, the most popular function is the logit function. Note that some older analyses might reference the probit function. Performing regression by using the logit function is known as logistic regression (the inverse of the logit function is known as the logistic function). The name might seem confusing since technically this algorithm is used to perform classification, but since logistic regression borrows heavily in its approach from linear regression, the descriptive name was maintained. A major benefit of logistic regression is the creation of a parametric model that can be explored to understand why predictions are made, in the same manner as a linear regression model.</p>
<p>In this section, we introduce the logit function and how it can be used to construct a binary model. Next, we introduce logistic regression, and specifically show how logistic regression can be performed. We also introduce several popular performance metrics and show how they can be calculated for binary classification tasks. We demonstrate logistic regression on several data sets, including one that contains categorical features. We also demonstrate how to perform logistic regression. Finally, we discuss topics such as marginal effects and odds ratios, which are concepts that often prove useful in interpreting logistic regression models.</p>
<h1 id="formalism">Formalism</h1>
<p>In a binary classification process, we have two possible outcomes, which for the sake of generality, we can label as <em>Success</em> or <em>Failure</em>. Denoting the probability of these two outcomes as <span class="math inline">\(P(S)\)</span> and <span class="math inline">\(P(F)\)</span> respectively, we can write the probability of success as <span class="math inline">\(P(S)=p\)</span>, and the probability of failure as <span class="math inline">\(P(F)=1p\)</span>. Thus, the odds of a successful outcome, which is the ratio of the probability of success to the probability of failure, is given by the following expression:</p>
<p><span class="math display">\[
\textrm{Odds}(S) = \frac{p}{1 - p}
\]</span></p>
<p>We can extend the framework of <em>linear regression</em> to the task of binary classification by employing a mapping between the continuous value predicted by a linear regressor and the probability of an event occurring, which is bounded by the range <span class="math inline">\([0,1]\)</span>. To do this, we need a function that maps the real numbers into this range, which enables a regression onto a set of discrete values (0 or 1) that provides us the binary classification. One popular choice for this function is the <em>logit</em> function, while another choice is the <em>probit</em> function. The use of these functions for a classification task leads to <em>logistic regression</em> or <em>probit regression</em>. While we focus in this section on the application of logistic regression for the binary classification task, this approach can be generalized to classify into more than two categories, this more advanced technique is known as <a href="https://en.wikipedia.org/wiki/Multinomial_logistic_regression">multinomial logistic regression</a>.</p>
<h2 id="logit-function">Logit Function</h2>
<p>The <a href="https://en.wikipedia.org/wiki/Logit"><em>logit</em> function</a> is defined as the logarithm of the odds (i.e, <span class="math inline">\(p/(1p)\)</span>), which is also known as the <em>log-odds</em>. Thus, the <em>logit</em> function can be written for a probability of success <span class="math inline">\(p\)</span>:</p>
<p><span class="math display">\[
\textrm{logit}(p) = \log\left(\frac{p}{1 - p}\right) , where 0 \leq p \leq 1
\]</span></p>
<p>We can invert this relationship to obtain the <a href="https://en.wikipedia.org/wiki/Logistic_function"><em>logistic</em> function</a>, which for a parameter <span class="math inline">\(\)</span> is defined by the following expression:</p>
<p><span class="math display">\[
\textrm{logit}^{-1}(\alpha) = \textrm{logistic}(\alpha) = \frac{1}{1 + \exp{(-\alpha})}
\]</span></p>
<p>While the logistic function is most commonly used to perform this type of regression, a related function is the <a href="https://en.wikipedia.org/wiki/Probit"><em>probit</em> function</a>, which stands for <em>probability unit</em> and is sometimes used in lieu of the <em>logit</em> function. The <em>probit</em> function is defined for a probability of success, pp:</p>
<p><span class="math display">\[
\textrm{probit}(p) = \sqrt{2}erf^{-1}(2p - 1), \ where \ 0 \leq p \leq 1 \, and \ erf \ is \ the \ Error \ Function.
\]</span></p>
<p>The logit function (and the probit function) is an <em>S</em> shaped curve that converts real numbers into a probability. Both the logit and probit functions are related to the <em>sigmoid</em> function, but are centered at the origin (0, 0). For the rest of this section, we will only consider the logit function. In the following Code chunk, we plot the <strong>logistic</strong> function, or the inverse of the <strong>logit</strong> function, demonstrating how the real numbers can be mapped into the range <span class="math inline">\([0,1]\)</span>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#compute x y axis</span>
<span class='va'>x</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>10</span>,<span class='fl'>10</span>,<span class='fl'>.5</span><span class='op'>)</span>
<span class='va'>y</span><span class='op'>&lt;-</span><span class='fl'>1</span><span class='op'>/</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>

<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>y</span><span class='op'>)</span><span class='op'>)</span>,<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>y</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>color<span class='op'>=</span><span class='st'>"lightblue"</span>,size<span class='op'>=</span><span class='fl'>.75</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_hline</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>yintercept<span class='op'>=</span><span class='fl'>.5</span><span class='op'>)</span>,color<span class='op'>=</span><span class='st'>"black"</span>,linetype<span class='op'>=</span><span class='st'>"dashed"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='va'>alpha</span><span class='op'>)</span>, y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='va'>Rho</span><span class='op'>)</span>, title<span class='op'>=</span><span class='st'>'Logistic Function'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust<span class='op'>=</span><span class='fl'>0.25</span>, size<span class='op'>=</span><span class='fl'>15</span>, face<span class='op'>=</span><span class='st'>'bold'</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Logistic_Regression_files/figure-html5/logistic1-1.png" width="624" /></p>
</div>
<h2 id="gradient-descent">Gradient Descent</h2>
<p>Given the previously defined <em>logistic</em> function, we can develop the formalism of <em>logistic regression</em> by first employing a linear regression model to predict a dependent variable from the set of independent features. Second, we apply the logistic function to the dependent variable in the linear regression model to make our binary classification prediction. Thus, if we have the following linear model:</p>
<p><span class="math display">\[y=mx+b\]</span></p>
<p>The logistic regression model fits the following logistic model:</p>
<p><span class="math display">\[\textrm{logistic}(y) = \frac{1}{1 + \exp(-y)}\]</span></p>
<p>The generally used cost (or loss) function for logistic regression is the sum of the squared errors between the actual classes and the predicted classes. One of the most popular techniques for finding the minimum of this cost function is to use <a href="https://en.wikipedia.org/wiki/Stochastic_gradient_descent"><em>stochastic gradient descent</em></a>. <a href="https://en.wikipedia.org/wiki/Gradient_descent">Gradient descent</a> computes the derivative of (or finds the slope of the tangent line to) the cost function at a particular point. This can be used to modify the parameters of our model to move in a direction that is expected to reach the minimum of the cost function. Standard gradient descent computes these corrections by summing up all the contributions from each training data point. In stochastic gradient descent (or <strong>SGD</strong>), however, the corrections are computed for each training point. As a result, SGD often generates a path towards the minimum that is somewhat rambling, but this has the benefit of avoiding local minima and being more robust.</p>
<p>The following Code cell generates a figure to help explain gradient descent. A fictitious cost function is displayed, along with the tangent (or derivative) at a particular point. The arrows specify the direction that the derivative indicates we must move to reach the minimum. The repeated use of arrows signifies how an incremental approach to gradient descent, such as that employed by stochastic gradient descent, might converge to the true minimum of the cost function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>x</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>4</span>,<span class='fl'>4</span>,length.out<span class='op'>=</span><span class='fl'>100</span><span class='op'>)</span>
<span class='va'>y</span><span class='op'>=</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>2</span>

<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>y</span><span class='op'>)</span><span class='op'>)</span>,<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>x</span>,<span class='va'>y</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>color<span class='op'>=</span><span class='st'>"lightblue"</span>,size<span class='op'>=</span><span class='fl'>.75</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_abline</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>intercept<span class='op'>=</span><span class='op'>-</span><span class='fl'>1</span>,slope<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>,color<span class='op'>=</span><span class='st'>"red"</span>,linetype<span class='op'>=</span><span class='st'>"dashed"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>xlim</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>ylim</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>.5</span>,<span class='fl'>10</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span><span class='op'>)</span>,pch<span class='op'>=</span><span class='fl'>4</span>,col<span class='op'>=</span><span class='st'>"red"</span>,size<span class='op'>=</span><span class='fl'>2</span>,stroke<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>, y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='va'>y</span><span class='op'>)</span>, title<span class='op'>=</span><span class='st'>'Gradient Descent'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust<span class='op'>=</span><span class='fl'>0.25</span>, size<span class='op'>=</span><span class='fl'>15</span>, face<span class='op'>=</span><span class='st'>'bold'</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fl'>2.75</span>, y<span class='op'>=</span><span class='fl'>4</span>, label<span class='op'>=</span><span class='st'>"Decent"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fl'>2.3</span>, y<span class='op'>=</span><span class='fl'>4</span>, label<span class='op'>=</span><span class='st'>"Gradient"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_text.html'>geom_text</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fl'>0</span>, y<span class='op'>=</span><span class='op'>-</span><span class='fl'>.5</span>, label<span class='op'>=</span><span class='st'>"Minimum"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Logistic_Regression_files/figure-html5/logitgradient-1.png" width="624" /></p>
</div>
<p>Another example of Gradient Descent<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>Consider the following function:</p>
<p><span class="math display">\[ h_{\theta}=1.2(x-2)^2 + 3.2 \]</span></p>
<p>So we can state our objective to minimize <span class="math inline">\(\theta_1\)</span> or <span class="math inline">\(\min\limits_{\theta_1}J(\theta_1)\)</span> and <span class="math inline">\(\theta_1\in\mathbb{R}\)</span></p>
<h3 id="cost-function">Cost function</h3>
<p>We define the cost function <span class="math inline">\(J(\theta_1)\)</span> using calculus as <span class="math inline">\(J(\theta)=2.4(x2)\)</span></p>
<p>$$ <span class="math display">\[\begin{multline}
\text{repeat until convergence} \{\\
 
\theta_1:=\theta_1 - \alpha\frac{d}{d\theta_1}J(\theta_1)\\
 
\}
\end{multline}\]</span> $$</p>
<ul>
<li>where <span class="math inline">\(\)</span> is the learning rate governing the size of the step take with each iteration.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://magrittr.tidyverse.org'>magrittr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
 
 
<span class='va'>xs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>4</span>,len <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span> <span class='co'># create some values</span>
 
<span class='co'># define the function we want to optimize</span>
 
<span class='va'>f</span> <span class='op'>&lt;-</span>  <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fl'>1.2</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>x</span><span class='op'>-</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>+</span> <span class='fl'>3.2</span>
  <span class='op'>}</span>
 
<span class='co'># plot the function </span>
 
<span class='va'>create_plot</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>title</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span>
    ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>8</span><span class='op'>)</span>,
    x <span class='op'>=</span> <span class='va'>xs</span>,
    y <span class='op'>=</span> <span class='fu'>f</span><span class='op'>(</span><span class='va'>xs</span><span class='op'>)</span>, 
    type <span class='op'>=</span> <span class='st'>"l"</span>, 
    ylab <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='fl'>1.2</span><span class='op'>(</span><span class='va'>x</span><span class='op'>-</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>2</span> <span class='op'>+</span> <span class='fl'>3.2</span><span class='op'>)</span>,
    xlab <span class='op'>=</span> <span class='st'>"x"</span>,
    main <span class='op'>=</span> <span class='va'>title</span>
    <span class='op'>)</span>
  
  <span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>
    h <span class='op'>=</span> <span class='fl'>3.2</span>,
    v <span class='op'>=</span> <span class='fl'>2</span>, 
    col <span class='op'>=</span> <span class='st'>"red"</span>, 
    type <span class='op'>=</span> <span class='fl'>2</span>
    <span class='op'>)</span>
  
<span class='op'>}</span>
 
<span class='co'># J(theta)</span>
 
<span class='va'>cost</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>{</span>
  <span class='fl'>1.2</span> <span class='op'>*</span> <span class='fl'>2</span> <span class='op'>*</span> <span class='op'>(</span><span class='va'>x</span><span class='op'>-</span><span class='fl'>2</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Below is the actual implementation of gradient descent.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># gradient descent implementation</span>
 
<span class='va'>grad</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span> <span class='op'>=</span> <span class='fl'>0.1</span>, <span class='va'>alpha</span> <span class='op'>=</span> <span class='fl'>0.6</span>, <span class='va'>j</span> <span class='op'>=</span> <span class='fl'>1000</span><span class='op'>)</span> <span class='op'>{</span>
  
  <span class='va'>xtrace</span> <span class='op'>&lt;-</span> <span class='va'>x</span>
  <span class='va'>ftrace</span> <span class='op'>&lt;-</span> <span class='fu'>f</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
  
  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>j</span><span class='op'>)</span> <span class='op'>{</span>
    
    <span class='va'>x</span> <span class='op'>&lt;-</span> <span class='va'>x</span> <span class='op'>-</span> <span class='va'>alpha</span> <span class='op'>*</span> <span class='fu'>cost</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
    
    <span class='va'>xtrace</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>xtrace</span>,<span class='va'>x</span><span class='op'>)</span>
    <span class='va'>ftrace</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>ftrace</span>,<span class='fu'>f</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
    
    <span class='op'>}</span>
  
  <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
    <span class='st'>"x"</span> <span class='op'>=</span> <span class='va'>xtrace</span>,
    <span class='st'>"f_x"</span> <span class='op'>=</span> <span class='va'>ftrace</span>
    <span class='op'>)</span>
  <span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Now I use the plotting function to produce plots, and populate these with points using the gradient descent algorithm.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>create_plot</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='va'>Low</span><span class='op'>~</span><span class='va'>alpha</span><span class='op'>)</span><span class='op'>)</span>
 
<span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span>
  <span class='va'>alpha_too_low</span> <span class='op'>&lt;-</span> <span class='fu'>grad</span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='fl'>0.1</span>, <span class='co'># initialisation of x</span>
    alpha <span class='op'>=</span> <span class='fl'>0.1</span>, <span class='co'># learning rate</span>
    j <span class='op'>=</span> <span class='fl'>100</span> <span class='co'># iterations</span>
    <span class='op'>)</span>,
  <span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span>
    <span class='va'>x</span>, 
    <span class='va'>f_x</span>, 
    type <span class='op'>=</span> <span class='st'>"b"</span>, 
    col <span class='op'>=</span> <span class='st'>"green"</span>
    <span class='op'>)</span>
  <span class='op'>)</span>
</code></pre>
</div>
<img src="Logistic_Regression_files/figure-html5/gradient_borrowed3-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>create_plot</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='va'>alpha</span><span class='op'>~</span><span class='va'>just</span><span class='op'>~</span><span class='va'>right</span><span class='op'>)</span><span class='op'>)</span>
 
<span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span>
  <span class='va'>alpha_just_right</span> <span class='op'>&lt;-</span> <span class='fu'>grad</span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='fl'>0.1</span>, <span class='co'># initialisation of x</span>
    alpha <span class='op'>=</span> <span class='fl'>0.6</span>, <span class='co'># learning rate</span>
    j <span class='op'>=</span> <span class='fl'>100</span> <span class='co'># iterations</span>
    <span class='op'>)</span>,
  <span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span>
    <span class='va'>x</span>, 
    <span class='va'>f_x</span>, 
    type <span class='op'>=</span> <span class='st'>"b"</span>,  
    col <span class='op'>=</span> <span class='st'>"blue"</span>
    <span class='op'>)</span>
  <span class='op'>)</span>
</code></pre>
</div>
<img src="Logistic_Regression_files/figure-html5/gradient_borrowed3-2.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>create_plot</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span><span class='op'>(</span><span class='va'>High</span><span class='op'>~</span><span class='va'>alpha</span><span class='op'>)</span><span class='op'>)</span>
 
<span class='fu'><a href='https://rdrr.io/r/base/with.html'>with</a></span><span class='op'>(</span>
  <span class='va'>alpha_too_high</span> <span class='op'>&lt;-</span> <span class='fu'>grad</span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='fl'>0.1</span>, <span class='co'># initialisation of x</span>
    alpha <span class='op'>=</span> <span class='fl'>0.8</span>, <span class='co'># learning rate</span>
    j <span class='op'>=</span> <span class='fl'>100</span> <span class='co'># iterations</span>
    <span class='op'>)</span>,
  <span class='fu'><a href='https://rdrr.io/r/graphics/points.html'>points</a></span><span class='op'>(</span>
    <span class='va'>x</span>, 
    <span class='va'>f_x</span>, 
    type <span class='op'>=</span> <span class='st'>"b"</span>,
    col <span class='op'>=</span> <span class='st'>"red"</span>
    <span class='op'>)</span>
  <span class='op'>)</span>
</code></pre>
</div>
<p><img src="Logistic_Regression_files/figure-html5/gradient_borrowed3-3.png" width="624" /></p>
</div>
<p>Another way to look at the rate of convergence is to plot the number of iterations against the output of <span class="math inline">\(f(x)\)</span>. Vertical lines show when convergence occurs. When <span class="math inline">\(\alpha\)</span> is set very low, it takes much longer than necessary (although it does converge). When <span class="math inline">\(\alpha\)</span> is too high, convergence doesnt occur at all within a hundred iterations.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
 
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>alpha_too_low</span><span class='op'>$</span><span class='va'>x</span>, type <span class='op'>=</span> <span class='st'>"l"</span>,col <span class='op'>=</span> <span class='st'>"green"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v <span class='op'>=</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>alpha_too_low</span><span class='op'>$</span><span class='va'>x</span>,<span class='fl'>4</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>which</span> <span class='op'>%&gt;%</span> <span class='va'>length</span><span class='op'>)</span>
 
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>alpha_just_right</span><span class='op'>$</span><span class='va'>x</span>, type <span class='op'>=</span> <span class='st'>"l"</span>,col <span class='op'>=</span> <span class='st'>"blue"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v <span class='op'>=</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>alpha_just_right</span><span class='op'>$</span><span class='va'>x</span>,<span class='fl'>4</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>which</span> <span class='op'>%&gt;%</span> <span class='va'>length</span><span class='op'>)</span>
 
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>alpha_too_high</span><span class='op'>$</span><span class='va'>x</span>, type <span class='op'>=</span> <span class='st'>"l"</span>, col <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v <span class='op'>=</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>alpha_too_high</span><span class='op'>$</span><span class='va'>x</span>,<span class='fl'>4</span><span class='op'>)</span> <span class='op'>!=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='va'>which</span> <span class='op'>%&gt;%</span> <span class='va'>length</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Logistic_Regression_files/figure-html5/gradient_borrowed4-1.png" width="624" /></p>
</div>
<h1 id="logistic-modeling">Logistic Modeling</h1>
<p>Before introducing logistic regression, we first show how the logistic function can be used to model binary response data. For this purpose, we will use data from NASA on the relationship between the outside temperature when the space shuttle was launched, and the occurrence of a thermal failure of an O-ring on a booster rocket. We will use this data to create a predictive model between temperature and thermal failure; note that it is believed that the <a href="https://en.wikipedia.org/wiki/Space_Shuttle_Solid_Rocket_Booster#Challenger_disaster">failure of an O-ring</a> on a solid rocket booster led to the Challenger disaster.</p>
<p>The actual data we use is hosted at the University of California at Irvine (UCI) machine learning data repository.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># install.packages("devtools")</span>
<span class='fu'>devtools</span><span class='fu'>::</span><span class='fu'><a href='https://devtools.r-lib.org//reference/remote-reexports.html'>install_github</a></span><span class='op'>(</span><span class='st'>"tyluRp/ucimlr"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
<span class='co'>#its two datasets...pick the first one in the list</span>
<span class='va'>NASA</span><span class='op'>&lt;-</span><span class='fu'>ucimlr</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/pkg/ucimlr/man/challenger.html'>challenger</a></span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>

<span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='fu'>psych</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/psych/man/describe.html'>describe</a></span><span class='op'>(</span><span class='va'>NASA</span><span class='op'>)</span><span class='op'>)</span><span class='op'>%&gt;%</span>
    <span class='fu'>kableExtra</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/kableExtra/man/kable_styling.html'>kable_styling</a></span><span class='op'>(</span><span class='st'>"striped"</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'>kableExtra</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/kableExtra/man/scroll_box.html'>scroll_box</a></span><span class='op'>(</span>width<span class='op'>=</span><span class='st'>"100%"</span>,height<span class='op'>=</span><span class='st'>"200px"</span><span class='op'>)</span>
</code></pre>
</div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:200px; overflow-x: scroll; width:100%; ">
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
vars
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
n
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mean
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
sd
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
median
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
trimmed
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mad
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
min
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
max
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
range
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
skew
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
kurtosis
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
se
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
o_rings_at_risk
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
6.0000000
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6.0000000
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
NaN
</td>
<td style="text-align:right;">
0.000000
</td>
</tr>
<tr>
<td style="text-align:left;">
thermal_distress
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
0.3043478
</td>
<td style="text-align:right;">
0.558796
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.2105263
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1.5148606
</td>
<td style="text-align:right;">
1.2736250
</td>
<td style="text-align:right;">
0.116517
</td>
</tr>
<tr>
<td style="text-align:left;">
launch_temp
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
69.5652174
</td>
<td style="text-align:right;">
7.057080
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
70.0000000
</td>
<td style="text-align:right;">
5.9304
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
81
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
-0.5709113
</td>
<td style="text-align:right;">
-0.2705987
</td>
<td style="text-align:right;">
1.471503
</td>
</tr>
<tr>
<td style="text-align:left;">
leak_check_pressure
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
152.1739130
</td>
<td style="text-align:right;">
68.221332
</td>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
157.8947368
</td>
<td style="text-align:right;">
0.0000
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
200
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
-0.6905594
</td>
<td style="text-align:right;">
-1.5002209
</td>
<td style="text-align:right;">
14.225131
</td>
</tr>
<tr>
<td style="text-align:left;">
temporal_order_of_flight
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
12.0000000
</td>
<td style="text-align:right;">
6.782330
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
12.0000000
</td>
<td style="text-align:right;">
8.8956
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-1.3572779
</td>
<td style="text-align:right;">
1.414214
</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr />
<p>From this summary description we can identify several important points. First, there are 23 instances in this data set. Second, this summary indicates that there are no missing values, since each feature has the same number in the <code>n</code> column, and the <code>min</code> column always contains a valid number. On the other hand, we notice that the maximum value for the number of thermal distresses is two, not one like we require for a binary classification task, which should be zero or one. Thus, our next step is to determine how many instances have a value of two for the <code>thermal_distress</code> feature.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>NASA</span><span class='op'>$</span><span class='va'>thermal_distress</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
 0  1  2 
17  5  1 </code></pre>
</div>
<p>As the output demonstrates, we only have one instance that records more than one thermal distress. At this point we have three options:</p>
<ol type="1">
<li><p>delete this instance,</p></li>
<li><p>duplicate this instance so that two single failure instances exist in the data set, or</p></li>
<li><p>change this instance to report only a single thermal distress.</p></li>
</ol>
<p>While any of these options might be valid from an algorithmic perspective, they differ from a modeling perspective. The first option would remove valuable data from our set, which is already small. This would also make our model less predictive since this was an actual failure, and we likely do not want to under predict failures, which could have devastating effects. On the other hand, duplicating this instance would be the same as having two separate launches at the same temperature. This could also be problematic, as it would overemphasize a failure at a given temperature.</p>
<p>As a result, we will instead convert this instance to a single thermal distress. The reason in this case is that this measurement did find an instance of a thermal distress, and we are creating a model between temperature and the probability of a thermal failure.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>NASA2</span><span class='op'>&lt;-</span><span class='va'>NASA</span><span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>thermal_distress<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>thermal_distress</span><span class='op'>&gt;</span><span class='fl'>1</span>,<span class='fl'>1</span>,<span class='va'>thermal_distress</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>NASA2</span><span class='op'>$</span><span class='va'>thermal_distress</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
 0  1 
17  6 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#fit logistic regression model</span>
<span class='va'>model</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>thermal_distress</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>launch_temp</span>, data<span class='op'>=</span><span class='va'>NASA2</span>, family<span class='op'>=</span><span class='va'>binomial</span><span class='op'>)</span>

<span class='co'>#define new data frame that contains predictor variable</span>
<span class='va'>newdata</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>launch_temp<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>NASA2</span><span class='op'>$</span><span class='va'>launch_temp</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>NASA2</span><span class='op'>$</span><span class='va'>launch_temp</span><span class='op'>)</span>,len<span class='op'>=</span><span class='fl'>500</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#use fitted model to predict values of vs</span>
<span class='va'>newdata</span><span class='op'>$</span><span class='va'>thermal_distress</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>model</span>, <span class='va'>newdata</span>, type<span class='op'>=</span><span class='st'>"response"</span><span class='op'>)</span>

<span class='co'>#plot logistic regression curve</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>thermal_distress</span> <span class='op'>~</span> <span class='va'>launch_temp</span>, data<span class='op'>=</span><span class='va'>NASA2</span>, col<span class='op'>=</span><span class='st'>"steelblue"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span><span class='op'>(</span><span class='va'>thermal_distress</span> <span class='op'>~</span> <span class='va'>launch_temp</span>, <span class='va'>newdata</span>, lwd<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<img src="Logistic_Regression_files/figure-html5/runlogit-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#using ggplot</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>

<span class='co'>#plot logistic regression curve</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>NASA2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>launch_temp</span>, y<span class='op'>=</span><span class='va'>thermal_distress</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>alpha<span class='op'>=</span><span class='fl'>.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>stat_smooth</a></span><span class='op'>(</span>method<span class='op'>=</span><span class='st'>"glm"</span>, se<span class='op'>=</span><span class='cn'>FALSE</span>, method.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>family<span class='op'>=</span><span class='va'>binomial</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='st'>"launch temperature"</span>, y<span class='op'>=</span><span class='st'>"thermal distress"</span>, title<span class='op'>=</span><span class='st'>'logistic regression'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust<span class='op'>=</span><span class='fl'>0.25</span>, size<span class='op'>=</span><span class='fl'>15</span>, face<span class='op'>=</span><span class='st'>'bold'</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Logistic_Regression_files/figure-html5/runlogit-2.png" width="624" /></p>
</div>
<p>Given a predictive model such as our computed logit model, we can also predict for new, unseen data. In this case, we can predict the probability of thermal failure for a given temperature. The following Code cell computes and displays these probabilities as a function of temperature. Note, that the temperature at launch during the Challenger disaster was 36 degrees Fahrenheit.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>36</span>, <span class='fl'>58</span>, <span class='fl'>65</span>, <span class='fl'>72</span>, <span class='fl'>88</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
 
  <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>i</span>,<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>model</span>,<span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>launch_temp<span class='op'>=</span><span class='va'>i</span><span class='op'>)</span>,type<span class='op'>=</span><span class='st'>"response"</span><span class='op'>)</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

  <span class='op'>}</span>
</code></pre>
</div>
<pre><code>[1] &quot;36 1&quot;
[1] &quot;58 0.925&quot;
[1] &quot;65 0.485&quot;
[1] &quot;72 0.067&quot;
[1] &quot;88 0&quot;</code></pre>
</div>
<h2 id="logistic-regression">Logistic Regression</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/topepo/caret/'>caret</a></span><span class='op'>)</span>
<span class='co'>#set the seed :)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='co'>#get our samples</span>

<span class='co'>#lets split the data 60/40</span>

<span class='va'>trainIndex</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/caret/man/createDataPartition.html'>createDataPartition</a></span><span class='op'>(</span><span class='va'>NASA2</span><span class='op'>$</span><span class='va'>thermal_distress</span>, p <span class='op'>=</span> <span class='fl'>.6</span>, list <span class='op'>=</span> <span class='cn'>FALSE</span>, times <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='co'>#look at the first few</span>
<span class='co'>#head(trainIndex)</span>

<span class='co'>#grab the data</span>
<span class='va'>logisticTrain</span> <span class='op'>&lt;-</span> <span class='va'>NASA2</span><span class='op'>[</span> <span class='va'>trainIndex</span>,<span class='op'>]</span>
<span class='va'>logisticTest</span>  <span class='op'>&lt;-</span> <span class='va'>NASA2</span><span class='op'>[</span><span class='op'>-</span><span class='va'>trainIndex</span>,<span class='op'>]</span>


<span class='va'>NASA_logistic</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/caret/man/train.html'>train</a></span><span class='op'>(</span>
  form <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>thermal_distress</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>launch_temp</span>,
  data <span class='op'>=</span> <span class='va'>NASA2</span>,
  trControl <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/caret/man/trainControl.html'>trainControl</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"cv"</span>, number <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>,
  method <span class='op'>=</span> <span class='st'>"glm"</span>,
  family <span class='op'>=</span> <span class='st'>"binomial"</span>
<span class='op'>)</span>

<span class='va'>NASA_logistic</span>
</code></pre>
</div>
<pre><code>Generalized Linear Model 

23 samples
 1 predictor
 2 classes: &#39;0&#39;, &#39;1&#39; 

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 22, 20, 20, 22, 21, 20, ... 
Resampling results:

  Accuracy   Kappa    
  0.9333333  0.6666667</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>NASA_logistic</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
NULL

Deviance Residuals: 
     Min        1Q    Median        3Q       Max  
-1.00214  -0.57815  -0.21802   0.04401   2.01706  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)  23.7750    11.8204   2.011   0.0443 *
launch_temp  -0.3667     0.1752  -2.093   0.0363 *
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 26.402  on 22  degrees of freedom
Residual deviance: 14.426  on 21  degrees of freedom
AIC: 18.426

Number of Fisher Scoring iterations: 6</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>NASA_Pred</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>NASA_logistic</span>,<span class='va'>logisticTest</span>,type<span class='op'>=</span><span class='st'>"prob"</span><span class='op'>)</span>

<span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='va'>NASA_Pred</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr>
<th style="text-align:right;">
0
</th>
<th style="text-align:right;">
1
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.8692235
</td>
<td style="text-align:right;">
0.1307765
</td>
</tr>
<tr>
<td style="text-align:right;">
0.9523120
</td>
<td style="text-align:right;">
0.0476880
</td>
</tr>
<tr>
<td style="text-align:right;">
0.3378710
</td>
<td style="text-align:right;">
0.6621290
</td>
</tr>
<tr>
<td style="text-align:right;">
0.9920588
</td>
<td style="text-align:right;">
0.0079412
</td>
</tr>
<tr>
<td style="text-align:right;">
0.6886912
</td>
<td style="text-align:right;">
0.3113088
</td>
</tr>
<tr>
<td style="text-align:right;">
0.6886912
</td>
<td style="text-align:right;">
0.3113088
</td>
</tr>
<tr>
<td style="text-align:right;">
0.8692235
</td>
<td style="text-align:right;">
0.1307765
</td>
</tr>
<tr>
<td style="text-align:right;">
0.9836061
</td>
<td style="text-align:right;">
0.0163939
</td>
</tr>
</tbody>
</table>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>testpred</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>NASA_Pred</span><span class='op'>$</span><span class='va'>`1`</span>,<span class='va'>logisticTest</span><span class='op'>)</span>

<span class='va'>testpred</span><span class='op'>&lt;-</span><span class='va'>testpred</span><span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>NASA_Pred<span class='op'>=</span><span class='st'>"NASA_Pred$`1`"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>pROC</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/pROC/man/roc.html'>roc</a></span><span class='op'>(</span><span class='va'>testpred</span><span class='op'>$</span><span class='va'>thermal_distress</span>,<span class='va'>testpred</span><span class='op'>$</span><span class='va'>NASA_Pred</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/title.html'>title</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"AUC "</span>,<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'>pROC</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/pROC/man/roc.html'>roc</a></span><span class='op'>(</span><span class='va'>testpred</span><span class='op'>$</span><span class='va'>thermal_distress</span>,<span class='va'>testpred</span><span class='op'>$</span><span class='va'>NASA_Pred</span><span class='op'>)</span><span class='op'>$</span><span class='va'>auc</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<img src="Logistic_Regression_files/figure-html5/logisticreg-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>testpred</span><span class='op'>&lt;-</span><span class='va'>testpred</span><span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>prediction<span class='op'>=</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>NASA_Pred</span><span class='op'>&gt;</span><span class='fl'>.5</span>,<span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/caret/man/confusionMatrix.html'>confusionMatrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>testpred</span><span class='op'>$</span><span class='va'>prediction</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>testpred</span><span class='op'>$</span><span class='va'>thermal_distress</span><span class='op'>)</span>,positive <span class='op'>=</span> <span class='st'>"1"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction 0 1
         0 6 1
         1 0 1
                                          
               Accuracy : 0.875           
                 95% CI : (0.4735, 0.9968)
    No Information Rate : 0.75            
    P-Value [Acc &gt; NIR] : 0.3671          
                                          
                  Kappa : 0.6             
                                          
 Mcnemar&#39;s Test P-Value : 1.0000          
                                          
            Sensitivity : 0.5000          
            Specificity : 1.0000          
         Pos Pred Value : 1.0000          
         Neg Pred Value : 0.8571          
             Prevalence : 0.2500          
         Detection Rate : 0.1250          
   Detection Prevalence : 0.1250          
      Balanced Accuracy : 0.7500          
                                          
       &#39;Positive&#39; Class : 1               
                                          </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ConfusionTableR</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ConfusionTableR/man/binary_visualiseR.html'>binary_visualiseR</a></span><span class='op'>(</span>train_labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>testpred</span><span class='op'>$</span><span class='va'>prediction</span><span class='op'>)</span>,
                                   truth_labels<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>testpred</span><span class='op'>$</span><span class='va'>thermal_distress</span><span class='op'>)</span>,
                                   class_label1 <span class='op'>=</span> <span class='st'>"Thermal Distress"</span>, 
                                   class_label2 <span class='op'>=</span> <span class='st'>"Prediction"</span>,
                                   quadrant_col1 <span class='op'>=</span> <span class='st'>"#5D1725"</span>, 
                                   quadrant_col2 <span class='op'>=</span> <span class='st'>"#777777"</span>, 
                                   custom_title <span class='op'>=</span> <span class='st'>"Logistic Confusion Matrix"</span>, 
                                   text_col<span class='op'>=</span> <span class='st'>"black"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Logistic_Regression_files/figure-html5/confusion-1.png" width="672" /></p>
</div>
<h1 id="exercise-1">Exercise 1</h1>
<p>Using the code above:</p>
<ol type="1">
<li>Try including another feature in the model, such as <code>leak_check_pressure</code> or <code>temporal_order_of_flight</code>, one at a time. Do either of these features improve the performance?</li>
<li>Discuss at least 3 difference performance measures from the confusion matrix results from number 1.</li>
</ol>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#plot logistic regression curve</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>NASA2</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>launch_temp</span>, y<span class='op'>=</span><span class='va'>thermal_distress</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>alpha<span class='op'>=</span><span class='fl'>.5</span>,color<span class='op'>=</span><span class='st'>"lightblue"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_smooth.html'>stat_smooth</a></span><span class='op'>(</span>method<span class='op'>=</span><span class='st'>"glm"</span>, se<span class='op'>=</span><span class='cn'>FALSE</span>, method.args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>family<span class='op'>=</span><span class='va'>binomial</span><span class='op'>)</span>,color<span class='op'>=</span><span class='st'>"lightgreen"</span>,linetype <span class='op'>=</span> <span class='st'>"dashed"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='st'>"launch temperature"</span>, y<span class='op'>=</span><span class='st'>"thermal distress"</span>, title<span class='op'>=</span><span class='st'>'logistic regression'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust<span class='op'>=</span><span class='fl'>0.25</span>, size<span class='op'>=</span><span class='fl'>15</span>, face<span class='op'>=</span><span class='st'>'bold'</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>testpred</span>,<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>launch_temp</span>,y<span class='op'>=</span><span class='va'>prediction</span><span class='op'>)</span>,color<span class='op'>=</span><span class='st'>"pink"</span>,size<span class='op'>=</span><span class='fl'>1</span>,linetype <span class='op'>=</span> <span class='st'>"dashed"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Logistic_Regression_files/figure-html5/logisticwithpred-1.png" width="624" /></p>
</div>
<h1 id="sgd-classifier">SGD Classifier</h1>
<p>We now turn to the alternative technique for performing logistic regression. We can employ a stochastic gradient descent classifier to perform logistic regression. This has a benefit over the standard logistic regression estimator. This technique employs stochastic gradient descent, which can be <u><em>efficient</em></u> in finding the minimum of the cost function, especially with large and complex data sets. Stochastic gradient descent is based on standard gradient descent that was demonstrated graphically earlier, but is less prone to being trapped in local minima (or valleys).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#install.packages("sgd")</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/airoldilab/sgd'>sgd</a></span><span class='op'>)</span>

<span class='va'>sgdmodel</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/pkg/sgd/man/sgd.html'>sgd</a></span><span class='op'>(</span>formula<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>thermal_distress</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>launch_temp</span>,
              data<span class='op'>=</span><span class='va'>logisticTrain</span>,
              model<span class='op'>=</span><span class='st'>"glm"</span>,
              model.control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>family<span class='op'>=</span><span class='st'>"binomial"</span><span class='op'>)</span>,
              sgd.control<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>method<span class='op'>=</span><span class='st'>"sgd"</span><span class='op'>)</span>
              <span class='op'>)</span>
</code></pre>
</div>
<pre><code>Warning: Too few data points for plotting!</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>sgdmodel</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1]  -0.2499831 -16.4994252</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>sgdmodel</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>              Length Class  Mode     
model          1     -none- character
coefficients   2     -none- numeric  
converged      1     -none- logical  
estimates     48     -none- numeric  
pos           24     -none- numeric  
times         24     -none- numeric  
model.out      2     -none- list     
fitted.values 15     -none- numeric  
residuals     15     -none- numeric  </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#fitted(sgdmodel)</span>
<span class='co'>#plot(sgdmodel)</span>
<span class='co'>#print(sgdmodel)</span>

<span class='va'>NASA_Pred_sgd</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>sgdmodel</span>,<span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>logisticTest</span><span class='op'>$</span><span class='va'>launch_temp</span><span class='op'>)</span>,type <span class='op'>=</span> <span class='st'>"response"</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='va'>NASA_Pred_sgd</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr>
<th style="text-align:right;">
V1
</th>
<th style="text-align:right;">
V2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0e+00
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
0e+00
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
1e-07
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
0e+00
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
1e-07
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
1e-07
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
0e+00
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
0e+00
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>testpredsgd</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>NASA_Pred_sgd</span><span class='op'>$</span><span class='va'>V1</span> ,<span class='va'>logisticTest</span><span class='op'>)</span>

<span class='va'>testpredsgd</span><span class='op'>&lt;-</span><span class='va'>testpredsgd</span><span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>NASA_Pred_sgd<span class='op'>=</span><span class='st'>"NASA_Pred_sgd$V1"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>pROC</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/pROC/man/roc.html'>roc</a></span><span class='op'>(</span><span class='va'>testpredsgd</span><span class='op'>$</span><span class='va'>thermal_distress</span>,<span class='va'>testpredsgd</span><span class='op'>$</span><span class='va'>NASA_Pred_sgd</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/title.html'>title</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"AUC "</span>,<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'>pROC</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/pROC/man/roc.html'>roc</a></span><span class='op'>(</span><span class='va'>testpredsgd</span><span class='op'>$</span><span class='va'>thermal_distress</span>,<span class='va'>testpredsgd</span><span class='op'>$</span><span class='va'>NASA_Pred_sgd</span><span class='op'>)</span><span class='op'>$</span><span class='va'>auc</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="Logistic_Regression_files/figure-html5/sgd-1.png" width="624" /></p>
</div>
<h1 id="lr-tips-data">LR: Tips Data</h1>
<p>While the O-ring data was informative, it was small in both number of features and instances. As a result, we will now transition to the <em>tips</em> data. With this data set, we will first demonstrate logistic regression using only numeric features before including categorical features as well.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/jeroen/curl'>curl</a></span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/load.html'>load</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/curl/man/curl.html'>curl</a></span><span class='op'>(</span><span class='st'>"https://raw.githubusercontent.com/Professor-Hunt/ACC8143/main/data/tips.rda"</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#view the whole dataset</span>
<span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='va'>tips</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'>kableExtra</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/kableExtra/man/kable_styling.html'>kable_styling</a></span><span class='op'>(</span><span class='st'>"striped"</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'>kableExtra</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/kableExtra/man/scroll_box.html'>scroll_box</a></span><span class='op'>(</span>width <span class='op'>=</span> <span class='st'>"100%"</span>,height<span class='op'>=</span><span class='st'>"300px"</span><span class='op'>)</span>
</code></pre>
</div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table-striped" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
total_bill
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
tip
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
sex
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
smoker
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
day
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
time
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
size
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
16.99
</td>
<td style="text-align:right;">
1.01
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
10.34
</td>
<td style="text-align:right;">
1.66
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
21.01
</td>
<td style="text-align:right;">
3.50
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
23.68
</td>
<td style="text-align:right;">
3.31
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
24.59
</td>
<td style="text-align:right;">
3.61
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
25.29
</td>
<td style="text-align:right;">
4.71
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
8.77
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
26.88
</td>
<td style="text-align:right;">
3.12
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
15.04
</td>
<td style="text-align:right;">
1.96
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
14.78
</td>
<td style="text-align:right;">
3.23
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
10.27
</td>
<td style="text-align:right;">
1.71
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
35.26
</td>
<td style="text-align:right;">
5.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
15.42
</td>
<td style="text-align:right;">
1.57
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
18.43
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
14.83
</td>
<td style="text-align:right;">
3.02
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
21.58
</td>
<td style="text-align:right;">
3.92
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
10.33
</td>
<td style="text-align:right;">
1.67
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
16.29
</td>
<td style="text-align:right;">
3.71
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
16.97
</td>
<td style="text-align:right;">
3.50
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
20.65
</td>
<td style="text-align:right;">
3.35
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
17.92
</td>
<td style="text-align:right;">
4.08
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
20.29
</td>
<td style="text-align:right;">
2.75
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
15.77
</td>
<td style="text-align:right;">
2.23
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
39.42
</td>
<td style="text-align:right;">
7.58
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
19.82
</td>
<td style="text-align:right;">
3.18
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
17.81
</td>
<td style="text-align:right;">
2.34
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
13.37
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
12.69
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
21.70
</td>
<td style="text-align:right;">
4.30
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
19.65
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
9.55
</td>
<td style="text-align:right;">
1.45
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
18.35
</td>
<td style="text-align:right;">
2.50
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
15.06
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
20.69
</td>
<td style="text-align:right;">
2.45
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
17.78
</td>
<td style="text-align:right;">
3.27
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
24.06
</td>
<td style="text-align:right;">
3.60
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
16.31
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
16.93
</td>
<td style="text-align:right;">
3.07
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
18.69
</td>
<td style="text-align:right;">
2.31
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
31.27
</td>
<td style="text-align:right;">
5.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
16.04
</td>
<td style="text-align:right;">
2.24
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
17.46
</td>
<td style="text-align:right;">
2.54
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
13.94
</td>
<td style="text-align:right;">
3.06
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
9.68
</td>
<td style="text-align:right;">
1.32
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
30.40
</td>
<td style="text-align:right;">
5.60
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
18.29
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
22.23
</td>
<td style="text-align:right;">
5.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
32.40
</td>
<td style="text-align:right;">
6.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
28.55
</td>
<td style="text-align:right;">
2.05
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
18.04
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
12.54
</td>
<td style="text-align:right;">
2.50
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
10.29
</td>
<td style="text-align:right;">
2.60
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
34.81
</td>
<td style="text-align:right;">
5.20
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
9.94
</td>
<td style="text-align:right;">
1.56
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
25.56
</td>
<td style="text-align:right;">
4.34
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
19.49
</td>
<td style="text-align:right;">
3.51
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
38.01
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
26.41
</td>
<td style="text-align:right;">
1.50
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
11.24
</td>
<td style="text-align:right;">
1.76
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
48.27
</td>
<td style="text-align:right;">
6.73
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
20.29
</td>
<td style="text-align:right;">
3.21
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
13.81
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
11.02
</td>
<td style="text-align:right;">
1.98
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
18.29
</td>
<td style="text-align:right;">
3.76
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
17.59
</td>
<td style="text-align:right;">
2.64
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
20.08
</td>
<td style="text-align:right;">
3.15
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
16.45
</td>
<td style="text-align:right;">
2.47
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
3.07
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
20.23
</td>
<td style="text-align:right;">
2.01
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
15.01
</td>
<td style="text-align:right;">
2.09
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
12.02
</td>
<td style="text-align:right;">
1.97
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
17.07
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
26.86
</td>
<td style="text-align:right;">
3.14
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
25.28
</td>
<td style="text-align:right;">
5.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
14.73
</td>
<td style="text-align:right;">
2.20
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
10.51
</td>
<td style="text-align:right;">
1.25
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
17.92
</td>
<td style="text-align:right;">
3.08
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
27.20
</td>
<td style="text-align:right;">
4.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
22.76
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
17.29
</td>
<td style="text-align:right;">
2.71
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
19.44
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
16.66
</td>
<td style="text-align:right;">
3.40
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
10.07
</td>
<td style="text-align:right;">
1.83
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
32.68
</td>
<td style="text-align:right;">
5.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
15.98
</td>
<td style="text-align:right;">
2.03
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
34.83
</td>
<td style="text-align:right;">
5.17
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
13.03
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
18.28
</td>
<td style="text-align:right;">
4.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
24.71
</td>
<td style="text-align:right;">
5.85
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
21.16
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
28.97
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Fri
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
22.49
</td>
<td style="text-align:right;">
3.50
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Fri
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
5.75
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Fri
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
16.32
</td>
<td style="text-align:right;">
4.30
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Fri
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
22.75
</td>
<td style="text-align:right;">
3.25
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Fri
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
40.17
</td>
<td style="text-align:right;">
4.73
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Fri
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
27.28
</td>
<td style="text-align:right;">
4.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Fri
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
12.03
</td>
<td style="text-align:right;">
1.50
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Fri
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
21.01
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Fri
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
12.46
</td>
<td style="text-align:right;">
1.50
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Fri
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
11.35
</td>
<td style="text-align:right;">
2.50
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Fri
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
15.38
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Fri
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
44.30
</td>
<td style="text-align:right;">
2.50
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
22.42
</td>
<td style="text-align:right;">
3.48
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
20.92
</td>
<td style="text-align:right;">
4.08
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
15.36
</td>
<td style="text-align:right;">
1.64
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
20.49
</td>
<td style="text-align:right;">
4.06
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
25.21
</td>
<td style="text-align:right;">
4.29
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
18.24
</td>
<td style="text-align:right;">
3.76
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
14.31
</td>
<td style="text-align:right;">
4.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
14.00
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
7.25
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
38.07
</td>
<td style="text-align:right;">
4.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
23.95
</td>
<td style="text-align:right;">
2.55
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
25.71
</td>
<td style="text-align:right;">
4.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
17.31
</td>
<td style="text-align:right;">
3.50
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
29.93
</td>
<td style="text-align:right;">
5.07
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
10.65
</td>
<td style="text-align:right;">
1.50
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
12.43
</td>
<td style="text-align:right;">
1.80
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
24.08
</td>
<td style="text-align:right;">
2.92
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
11.69
</td>
<td style="text-align:right;">
2.31
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
13.42
</td>
<td style="text-align:right;">
1.68
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
14.26
</td>
<td style="text-align:right;">
2.50
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
15.95
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
12.48
</td>
<td style="text-align:right;">
2.52
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
29.80
</td>
<td style="text-align:right;">
4.20
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;">
8.52
</td>
<td style="text-align:right;">
1.48
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
14.52
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
11.38
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
22.82
</td>
<td style="text-align:right;">
2.18
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
19.08
</td>
<td style="text-align:right;">
1.50
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
20.27
</td>
<td style="text-align:right;">
2.83
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
11.17
</td>
<td style="text-align:right;">
1.50
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
12.26
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
18.26
</td>
<td style="text-align:right;">
3.25
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
8.51
</td>
<td style="text-align:right;">
1.25
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
10.33
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
14.15
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
16.00
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
13.16
</td>
<td style="text-align:right;">
2.75
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
17.47
</td>
<td style="text-align:right;">
3.50
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
34.30
</td>
<td style="text-align:right;">
6.70
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;">
41.19
</td>
<td style="text-align:right;">
5.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
27.05
</td>
<td style="text-align:right;">
5.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;">
16.43
</td>
<td style="text-align:right;">
2.30
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
8.35
</td>
<td style="text-align:right;">
1.50
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
18.64
</td>
<td style="text-align:right;">
1.36
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
11.87
</td>
<td style="text-align:right;">
1.63
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
9.78
</td>
<td style="text-align:right;">
1.73
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
7.51
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
14.07
</td>
<td style="text-align:right;">
2.50
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
13.13
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
17.26
</td>
<td style="text-align:right;">
2.74
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
24.55
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
19.77
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
29.85
</td>
<td style="text-align:right;">
5.14
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
48.17
</td>
<td style="text-align:right;">
5.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;">
25.00
</td>
<td style="text-align:right;">
3.75
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
13.39
</td>
<td style="text-align:right;">
2.61
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
16.49
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
21.50
</td>
<td style="text-align:right;">
3.50
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
12.66
</td>
<td style="text-align:right;">
2.50
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
16.21
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
13.81
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
17.51
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
24.52
</td>
<td style="text-align:right;">
3.48
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
20.76
</td>
<td style="text-align:right;">
2.24
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
31.71
</td>
<td style="text-align:right;">
4.50
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
10.59
</td>
<td style="text-align:right;">
1.61
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
10.63
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
50.81
</td>
<td style="text-align:right;">
10.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
15.81
</td>
<td style="text-align:right;">
3.16
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
7.25
</td>
<td style="text-align:right;">
5.15
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
31.85
</td>
<td style="text-align:right;">
3.18
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
16.82
</td>
<td style="text-align:right;">
4.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
32.90
</td>
<td style="text-align:right;">
3.11
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
17.89
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
14.48
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
9.60
</td>
<td style="text-align:right;">
4.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
34.63
</td>
<td style="text-align:right;">
3.55
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
34.65
</td>
<td style="text-align:right;">
3.68
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
23.33
</td>
<td style="text-align:right;">
5.65
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
45.35
</td>
<td style="text-align:right;">
3.50
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
23.17
</td>
<td style="text-align:right;">
6.50
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
40.55
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
20.69
</td>
<td style="text-align:right;">
5.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
20.90
</td>
<td style="text-align:right;">
3.50
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
30.46
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
18.15
</td>
<td style="text-align:right;">
3.50
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
23.10
</td>
<td style="text-align:right;">
4.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
15.69
</td>
<td style="text-align:right;">
1.50
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sun
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
19.81
</td>
<td style="text-align:right;">
4.19
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
28.44
</td>
<td style="text-align:right;">
2.56
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
15.48
</td>
<td style="text-align:right;">
2.02
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
16.58
</td>
<td style="text-align:right;">
4.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
7.56
</td>
<td style="text-align:right;">
1.44
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
10.34
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
43.11
</td>
<td style="text-align:right;">
5.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
13.00
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
13.51
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
18.71
</td>
<td style="text-align:right;">
4.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
12.74
</td>
<td style="text-align:right;">
2.01
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
13.00
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
16.40
</td>
<td style="text-align:right;">
2.50
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
20.53
</td>
<td style="text-align:right;">
4.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
16.47
</td>
<td style="text-align:right;">
3.23
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
26.59
</td>
<td style="text-align:right;">
3.41
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
38.73
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
24.27
</td>
<td style="text-align:right;">
2.03
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
12.76
</td>
<td style="text-align:right;">
2.23
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
30.06
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
25.89
</td>
<td style="text-align:right;">
5.16
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
48.33
</td>
<td style="text-align:right;">
9.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
13.27
</td>
<td style="text-align:right;">
2.50
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
28.17
</td>
<td style="text-align:right;">
6.50
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
12.90
</td>
<td style="text-align:right;">
1.10
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
28.15
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:right;">
11.59
</td>
<td style="text-align:right;">
1.50
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
7.74
</td>
<td style="text-align:right;">
1.44
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
30.14
</td>
<td style="text-align:right;">
3.09
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
12.16
</td>
<td style="text-align:right;">
2.20
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Fri
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
13.42
</td>
<td style="text-align:right;">
3.48
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Fri
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
8.58
</td>
<td style="text-align:right;">
1.92
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Fri
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
15.98
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Fri
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
13.42
</td>
<td style="text-align:right;">
1.58
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Fri
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
16.27
</td>
<td style="text-align:right;">
2.50
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Fri
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
10.09
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Fri
</td>
<td style="text-align:left;">
Lunch
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
20.45
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
13.28
</td>
<td style="text-align:right;">
2.72
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
22.12
</td>
<td style="text-align:right;">
2.88
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
24.01
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
15.69
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
11.61
</td>
<td style="text-align:right;">
3.39
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
10.77
</td>
<td style="text-align:right;">
1.47
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
15.53
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
10.07
</td>
<td style="text-align:right;">
1.25
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
12.60
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
32.83
</td>
<td style="text-align:right;">
1.17
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
35.83
</td>
<td style="text-align:right;">
4.67
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
29.03
</td>
<td style="text-align:right;">
5.92
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:right;">
27.18
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
22.67
</td>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
Yes
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
17.82
</td>
<td style="text-align:right;">
1.75
</td>
<td style="text-align:left;">
Male
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Sat
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
18.78
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:left;">
Female
</td>
<td style="text-align:left;">
No
</td>
<td style="text-align:left;">
Thur
</td>
<td style="text-align:left;">
Dinner
</td>
<td style="text-align:right;">
2
</td>
</tr>
</tbody>
</table>
</div>
</div>
<h2 id="numeric">Numeric</h2>
<p>To perform regression on the numeric features, we need both the numerical features and a target feature. For this example, we will attempt to predict if a patron is a smoker or not based solely on the three numerical features.</p>
<p>First, we separate the data into training and testing sets.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#set the seed :)</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span>
<span class='co'>#get our samples</span>

<span class='co'>#lets split the data 60/40</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/topepo/caret/'>caret</a></span><span class='op'>)</span>
<span class='va'>trainIndex</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/caret/man/createDataPartition.html'>createDataPartition</a></span><span class='op'>(</span><span class='va'>tips</span><span class='op'>$</span><span class='va'>tip</span>, p <span class='op'>=</span> <span class='fl'>.6</span>, list <span class='op'>=</span> <span class='cn'>FALSE</span>, times <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='co'>#look at the first few</span>
<span class='co'>#head(trainIndex)</span>

<span class='co'>#grab the data</span>
<span class='va'>tipsTrain</span> <span class='op'>&lt;-</span> <span class='va'>tips</span><span class='op'>[</span> <span class='va'>trainIndex</span>,<span class='op'>]</span>
<span class='va'>tipsTest</span>  <span class='op'>&lt;-</span> <span class='va'>tips</span><span class='op'>[</span><span class='op'>-</span><span class='va'>trainIndex</span>,<span class='op'>]</span>
</code></pre>
</div>
</div>
<p>Run the model</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>lrtips</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/caret/man/train.html'>train</a></span><span class='op'>(</span>
  form <span class='op'>=</span> <span class='va'>smoker</span><span class='op'>~</span><span class='va'>total_bill</span><span class='op'>+</span><span class='va'>tip</span><span class='op'>+</span><span class='va'>size</span>,
  data <span class='op'>=</span> <span class='va'>tipsTrain</span>,
  trControl <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/caret/man/trainControl.html'>trainControl</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"cv"</span>, number <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>,
  method <span class='op'>=</span> <span class='st'>"glm"</span>,
  family <span class='op'>=</span> <span class='st'>"binomial"</span>
<span class='op'>)</span>

<span class='va'>lrtips</span>
</code></pre>
</div>
<pre><code>Generalized Linear Model 

148 samples
  3 predictor
  2 classes: &#39;No&#39;, &#39;Yes&#39; 

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 133, 133, 133, 133, 134, 133, ... 
Resampling results:

  Accuracy   Kappa   
  0.6069048  0.114396</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>lrtips</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
NULL

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.2941  -1.0645  -0.7686   1.2476   1.9202  

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)  0.50471    0.53099   0.951  0.34186   
total_bill   0.04040    0.02664   1.516  0.12941   
tip          0.01735    0.17036   0.102  0.91886   
size        -0.67308    0.25898  -2.599  0.00935 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 200.58  on 147  degrees of freedom
Residual deviance: 192.12  on 144  degrees of freedom
AIC: 200.12

Number of Fisher Scoring iterations: 4</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>lrtips_Pred</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>lrtips</span>,<span class='va'>tipsTest</span>,type<span class='op'>=</span><span class='st'>"prob"</span><span class='op'>)</span>


<span class='va'>lrtipstestpred</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>lrtips_Pred</span>,<span class='va'>tipsTest</span><span class='op'>)</span>

<span class='va'>lrtipstestpred</span><span class='op'>&lt;-</span><span class='va'>lrtipstestpred</span><span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>lrtips_Pred<span class='op'>=</span><span class='st'>"Yes"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>pROC</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/pROC/man/roc.html'>roc</a></span><span class='op'>(</span><span class='va'>lrtipstestpred</span><span class='op'>$</span><span class='va'>smoker</span>,<span class='va'>lrtipstestpred</span><span class='op'>$</span><span class='va'>lrtips_Pred</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/title.html'>title</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"AUC "</span>,<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'>pROC</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/pROC/man/roc.html'>roc</a></span><span class='op'>(</span><span class='va'>lrtipstestpred</span><span class='op'>$</span><span class='va'>smoker</span>,<span class='va'>lrtipstestpred</span><span class='op'>$</span><span class='va'>lrtips_Pred</span><span class='op'>)</span><span class='op'>$</span><span class='va'>auc</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<img src="Logistic_Regression_files/figure-html5/lrtips3-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>lrtipstestpred</span><span class='op'>&lt;-</span><span class='va'>lrtipstestpred</span><span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>prediction<span class='op'>=</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>lrtips_Pred</span><span class='op'>&gt;</span><span class='fl'>.5</span>,<span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span>,
         target<span class='op'>=</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>smoker</span><span class='op'>==</span><span class='st'>"Yes"</span>,<span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>#confusionMatrix(factor(as.character(lrtipstestpred$prediction)),factor(as.character(lrtipstestpred$target)),positive = "1")</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Logistic_Regression_files/figure-html5/lrtips4%20-1.png" width="672" /></p>
</div>
<p>In this simple example, our model provides a reasonable performance, except for the excess <em>false positives</em> where we over predict smokers to be non-smokers. While there are several techniques we could explore to improve the performance of this simple model, the easiest will be to include additional features in our model. This will require including categorical features in our model, which is discussed in the next section.</p>
<h2 id="categorical-and-numeric">Categorical and Numeric</h2>
<p>Admittedly, our attempt to predict whether a patron is a smoker or not, based solely on the data in the <em>tips</em> data set, is ambitious. Even if the model fails to perform sufficiently well, we may gain insight into our data and the relationship between the features. As a result, we now transition to include categorical features in the model.</p>
<h3 id="run-model">Run Model</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>lrtips</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/caret/man/train.html'>train</a></span><span class='op'>(</span>
  form <span class='op'>=</span> <span class='va'>smoker</span><span class='op'>~</span><span class='va'>total_bill</span><span class='op'>+</span><span class='va'>tip</span><span class='op'>+</span><span class='va'>size</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>sex</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>day</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>time</span><span class='op'>)</span>,
  data <span class='op'>=</span> <span class='va'>tipsTrain</span>,
  trControl <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/caret/man/trainControl.html'>trainControl</a></span><span class='op'>(</span>method <span class='op'>=</span> <span class='st'>"none"</span><span class='op'>)</span>,
  method <span class='op'>=</span> <span class='st'>"glm"</span>,
  family <span class='op'>=</span> <span class='st'>"binomial"</span>
<span class='op'>)</span>

<span class='va'>lrtips</span>
</code></pre>
</div>
<pre><code>Generalized Linear Model 

148 samples
  6 predictor
  2 classes: &#39;No&#39;, &#39;Yes&#39; 

No pre-processing
Resampling: None </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>lrtips</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
NULL

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.5597  -0.9084  -0.6998   1.1320   1.9102  

Coefficients:
                      Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)            1.08464    0.86215   1.258   0.2084  
total_bill             0.03730    0.02771   1.346   0.1782  
tip                   -0.01976    0.17556  -0.113   0.9104  
size                  -0.50923    0.26907  -1.893   0.0584 .
`factor(sex)Male`      0.02892    0.38221   0.076   0.9397  
`factor(day)Sat`      -0.50089    0.77565  -0.646   0.5184  
`factor(day)Sun`      -1.22776    0.82277  -1.492   0.1356  
`factor(day)Thur`    -17.36662 1070.18524  -0.016   0.9871  
`factor(time)Lunch`   15.95472 1070.18542   0.015   0.9881  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 200.58  on 147  degrees of freedom
Residual deviance: 177.29  on 139  degrees of freedom
AIC: 195.29

Number of Fisher Scoring iterations: 15</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>lrtips_Pred</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>lrtips</span>,<span class='va'>tipsTest</span>,type<span class='op'>=</span><span class='st'>"prob"</span><span class='op'>)</span>


<span class='va'>lrtipstestpred</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>lrtips_Pred</span>,<span class='va'>tipsTest</span><span class='op'>)</span>

<span class='va'>lrtipstestpred</span><span class='op'>&lt;-</span><span class='va'>lrtipstestpred</span><span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>lrtips_Pred<span class='op'>=</span><span class='st'>"Yes"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='fu'>pROC</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/pROC/man/roc.html'>roc</a></span><span class='op'>(</span><span class='va'>lrtipstestpred</span><span class='op'>$</span><span class='va'>smoker</span>,<span class='va'>lrtipstestpred</span><span class='op'>$</span><span class='va'>lrtips_Pred</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/title.html'>title</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"AUC "</span>,<span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'>pROC</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/pROC/man/roc.html'>roc</a></span><span class='op'>(</span><span class='va'>lrtipstestpred</span><span class='op'>$</span><span class='va'>smoker</span>,<span class='va'>lrtipstestpred</span><span class='op'>$</span><span class='va'>lrtips_Pred</span><span class='op'>)</span><span class='op'>$</span><span class='va'>auc</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<img src="Logistic_Regression_files/figure-html5/lrtipsall-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>lrtipstestpred</span><span class='op'>&lt;-</span><span class='va'>lrtipstestpred</span><span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>prediction<span class='op'>=</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>lrtips_Pred</span><span class='op'>&gt;</span><span class='fl'>.5</span>,<span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span>,
         target<span class='op'>=</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span><span class='va'>smoker</span><span class='op'>==</span><span class='st'>"Yes"</span>,<span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="results">Results</h3>
<div class="layout-chunk" data-layout="l-body">
<p><img src="Logistic_Regression_files/figure-html5/lrtipsall2%20-1.png" width="672" /></p>
</div>
<h3 id="variable-importance">Variable importance</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>V</span><span class='op'>&lt;-</span><span class='fu'>caret</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/caret/man/varImp.html'>varImp</a></span><span class='op'>(</span><span class='va'>lrtips</span><span class='op'>)</span><span class='op'>$</span><span class='va'>importance</span><span class='op'>%&gt;%</span>
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>Overall</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='va'>V</span><span class='op'>)</span>
</code></pre>
</div>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
Overall
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
size
</td>
<td style="text-align:right;">
100.0000000
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>factor(day)Sun</code>
</td>
<td style="text-align:right;">
78.6777820
</td>
</tr>
<tr>
<td style="text-align:left;">
total_bill
</td>
<td style="text-align:right;">
70.9044038
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>factor(day)Sat</code>
</td>
<td style="text-align:right;">
33.5981121
</td>
</tr>
<tr>
<td style="text-align:left;">
tip
</td>
<td style="text-align:right;">
5.1994257
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>factor(sex)Male</code>
</td>
<td style="text-align:right;">
3.2359463
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>factor(day)Thur</code>
</td>
<td style="text-align:right;">
0.0702627
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>factor(time)Lunch</code>
</td>
<td style="text-align:right;">
0.0000000
</td>
</tr>
</tbody>
</table>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot2</span><span class='fu'>::</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>V</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/reorder.factor.html'>reorder</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>V</span><span class='op'>)</span>,<span class='va'>Overall</span><span class='op'>)</span>, y<span class='op'>=</span><span class='va'>Overall</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span> color<span class='op'>=</span><span class='st'>"blue"</span>, size<span class='op'>=</span><span class='fl'>4</span>, alpha<span class='op'>=</span><span class='fl'>0.6</span><span class='op'>)</span><span class='op'>+</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_segment.html'>geom_segment</a></span><span class='op'>(</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>V</span><span class='op'>)</span>, xend<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>V</span><span class='op'>)</span>, y<span class='op'>=</span><span class='fl'>0</span>, yend<span class='op'>=</span><span class='va'>Overall</span><span class='op'>)</span>, 
color<span class='op'>=</span><span class='st'>'skyblue'</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>'Variable'</span><span class='op'>)</span><span class='op'>+</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>'Overall Importance'</span><span class='op'>)</span><span class='op'>+</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_light</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/coord_flip.html'>coord_flip</a></span><span class='op'>(</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="Logistic_Regression_files/figure-html5/lrtipsall3-1.png" width="624" /></p>
</div>
<h3 id="regression-output">Regression Output</h3>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>stargazer</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/stargazer/man/stargazer.html'>stargazer</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>smoker</span><span class='op'>)</span><span class='op'>~</span><span class='va'>total_bill</span><span class='op'>+</span><span class='va'>tip</span><span class='op'>+</span><span class='va'>size</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>sex</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>day</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>time</span><span class='op'>)</span>,data<span class='op'>=</span><span class='va'>tipsTrain</span>,family <span class='op'>=</span> <span class='st'>"binomial"</span><span class='op'>)</span>,
                     title<span class='op'>=</span><span class='st'>"Tips Logistic Regression"</span>,
                     type <span class='op'>=</span> <span class='st'>"html"</span>,
                     float <span class='op'>=</span> <span class='cn'>TRUE</span>,
                     report <span class='op'>=</span> <span class='st'>"vcs*"</span>,
                     no.space <span class='op'>=</span> <span class='cn'>TRUE</span>,
                     header<span class='op'>=</span><span class='cn'>FALSE</span>,
                     single.row <span class='op'>=</span> <span class='cn'>TRUE</span>,
                    <span class='co'>#font.size = "small",</span>
                     intercept.bottom <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span>
</code></pre>
</div>
<table style="text-align:center">
<caption>
<strong>Tips Logistic Regression</strong>
</caption>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
factor(smoker)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
1.085 (0.862)
</td>
</tr>
<tr>
<td style="text-align:left">
total_bill
</td>
<td>
0.037 (0.028)
</td>
</tr>
<tr>
<td style="text-align:left">
tip
</td>
<td>
-0.020 (0.176)
</td>
</tr>
<tr>
<td style="text-align:left">
size
</td>
<td>
-0.509 (0.269)<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
factor(sex)Male
</td>
<td>
0.029 (0.382)
</td>
</tr>
<tr>
<td style="text-align:left">
factor(day)Sat
</td>
<td>
-0.501 (0.776)
</td>
</tr>
<tr>
<td style="text-align:left">
factor(day)Sun
</td>
<td>
-1.228 (0.823)
</td>
</tr>
<tr>
<td style="text-align:left">
factor(day)Thur
</td>
<td>
-17.367 (1,070.185)
</td>
</tr>
<tr>
<td style="text-align:left">
factor(time)Lunch
</td>
<td>
15.955 (1,070.185)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
148
</td>
</tr>
<tr>
<td style="text-align:left">
Log Likelihood
</td>
<td>
-88.646
</td>
</tr>
<tr>
<td style="text-align:left">
Akaike Inf. Crit.
</td>
<td>
195.293
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>
</div>
<h1 id="section"></h1>
<p>Exercise 2</p>
<ol type="1">
<li>Try predicting sex rather than the <code>smoker</code> feature by using all other features. Does the new model perform better or worse than the current model?</li>
<li>What was the most important variable in 1? Why do you think that is?</li>
</ol>
<h2 id="marginal-effects"><strong>Marginal Effects</strong></h2>
<p>One challenge when building a logistic model with multiple independent features is understanding the <em>true</em> effect of any one independent feature. To estimate these effects, one can compute the <em>marginal effects</em>, which quantifies the impact one feature has on the prediction while the other features are held constant. Formally this is done by taking the partial derivative of the model with respect to the feature of interest.</p>
<h2 id="odds-ratio"><strong>Odds Ratio</strong></h2>
<p>While marginal effect works well for numeric features, we cant take the derivative of a categorical, or discrete feature. Thus, we can also compute the <em>odds ratio</em> to determine the association between the presence or absence of two features. To compute an odds ratio, we hold one categorical value fixed, which is the reference group. This reference category was determined earlier when we held one categorical option out of the fit. Thus, when we calculate an odds ratio for the female instances, it is done with respect to the <code>sex=male</code> reference group.</p>
<p>We can use the odds ratio to determine the association, for example, between the <code>day</code> feature and the <code>time</code> feature, in order to determine if there is a relationship between these two features and the likelihood a patron is a smoker. The value of the odds ratio indicates how much more likely a patron is to be a smoker. We can also compute confidence intervals around these values to quantify the degrees of uncertainty associated with this ratio.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='st'>"mfx"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#standard logistic regression</span>
<span class='va'>regular_logit</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>smoker</span><span class='op'>)</span><span class='op'>~</span><span class='va'>total_bill</span><span class='op'>+</span><span class='va'>tip</span><span class='op'>+</span><span class='va'>size</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>sex</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>day</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>time</span><span class='op'>)</span>,data<span class='op'>=</span><span class='va'>tipsTrain</span>,family <span class='op'>=</span> <span class='st'>"binomial"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>regular_logit</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
Call:
glm(formula = factor(smoker) ~ total_bill + tip + size + factor(sex) + 
    factor(day) + factor(time), family = &quot;binomial&quot;, data = tipsTrain)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.5597  -0.9084  -0.6998   1.1320   1.9102  

Coefficients:
                    Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)          1.08464    0.86215   1.258   0.2084  
total_bill           0.03730    0.02771   1.346   0.1782  
tip                 -0.01976    0.17556  -0.113   0.9104  
size                -0.50923    0.26907  -1.893   0.0584 .
factor(sex)Male      0.02892    0.38221   0.076   0.9397  
factor(day)Sat      -0.50089    0.77565  -0.646   0.5184  
factor(day)Sun      -1.22776    0.82277  -1.492   0.1356  
factor(day)Thur    -17.36662 1070.18524  -0.016   0.9871  
factor(time)Lunch   15.95472 1070.18542   0.015   0.9881  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 200.58  on 147  degrees of freedom
Residual deviance: 177.29  on 139  degrees of freedom
AIC: 195.29

Number of Fisher Scoring iterations: 15</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#partial effects at the mean</span>
<span class='va'>Partial_atmean_logit</span><span class='op'>&lt;-</span><span class='fu'>mfx</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mfx/man/logitmfx.html'>logitmfx</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>smoker</span><span class='op'>)</span><span class='op'>~</span><span class='va'>total_bill</span><span class='op'>+</span><span class='va'>tip</span><span class='op'>+</span><span class='va'>size</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>sex</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>day</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>time</span><span class='op'>)</span>,data<span class='op'>=</span><span class='va'>tipsTrain</span>,atmean <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>Partial_atmean_logit</span>
</code></pre>
</div>
<pre><code>Call:
mfx::logitmfx(formula = factor(smoker) ~ total_bill + tip + size + 
    factor(sex) + factor(day) + factor(time), data = tipsTrain, 
    atmean = TRUE)

Marginal Effects:
                       dF/dx  Std. Err.       z  P&gt;|z|
total_bill         0.0093073  0.0161959  0.5747 0.5655
tip               -0.0049300  0.0444891 -0.1108 0.9118
size              -0.1270668  0.2109471 -0.6024 0.5469
factor(sex)Male    0.0072176  0.0960158  0.0752 0.9401
factor(day)Sat    -0.1245706  0.1920629 -0.6486 0.5166
factor(day)Sun    -0.2950866  0.9628751 -0.3065 0.7593
factor(day)Thur   -0.9941297  2.0273800 -0.4904 0.6239
factor(time)Lunch  0.9938448  1.9106874  0.5202 0.6030

dF/dx is for discrete change for the following variables:

[1] &quot;factor(sex)Male&quot;   &quot;factor(day)Sat&quot;    &quot;factor(day)Sun&quot;   
[4] &quot;factor(day)Thur&quot;   &quot;factor(time)Lunch&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#average partial effects</span>
<span class='va'>Avg_Partial_logit</span><span class='op'>&lt;-</span><span class='fu'>mfx</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mfx/man/logitmfx.html'>logitmfx</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>smoker</span><span class='op'>)</span><span class='op'>~</span><span class='va'>total_bill</span><span class='op'>+</span><span class='va'>tip</span><span class='op'>+</span><span class='va'>size</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>sex</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>day</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>time</span><span class='op'>)</span>,data<span class='op'>=</span><span class='va'>tipsTrain</span>,atmean <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>Avg_Partial_logit</span>
</code></pre>
</div>
<pre><code>Call:
mfx::logitmfx(formula = factor(smoker) ~ total_bill + tip + size + 
    factor(sex) + factor(day) + factor(time), data = tipsTrain, 
    atmean = FALSE)

Marginal Effects:
                       dF/dx  Std. Err.        z   P&gt;|z|    
total_bill         0.0077624  0.0059353   1.3078 0.19093    
tip               -0.0041117  0.0365437  -0.1125 0.91042    
size              -0.1059756  0.0590282  -1.7953 0.07260 .  
factor(sex)Male    0.0060145  0.0794271   0.0757 0.93964    
factor(day)Sat    -0.0978173  0.1397785  -0.6998 0.48405    
factor(day)Sun    -0.2376075  0.1355610  -1.7528 0.07964 .  
factor(day)Thur   -0.5300138  0.0388655 -13.6371 &lt; 2e-16 ***
factor(time)Lunch  0.4713354  0.0392459  12.0098 &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

dF/dx is for discrete change for the following variables:

[1] &quot;factor(sex)Male&quot;   &quot;factor(day)Sat&quot;    &quot;factor(day)Sun&quot;   
[4] &quot;factor(day)Thur&quot;   &quot;factor(time)Lunch&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#odds Ratio</span>
<span class='va'>OR_logit</span><span class='op'>&lt;-</span><span class='fu'>mfx</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/mfx/man/logitor.html'>logitor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>smoker</span><span class='op'>)</span><span class='op'>~</span><span class='va'>total_bill</span><span class='op'>+</span><span class='va'>tip</span><span class='op'>+</span><span class='va'>size</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>sex</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>day</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>time</span><span class='op'>)</span>,data<span class='op'>=</span><span class='va'>tipsTrain</span><span class='op'>)</span>
<span class='va'>OR_logit</span>
</code></pre>
</div>
<pre><code>Call:
mfx::logitor(formula = factor(smoker) ~ total_bill + tip + size + 
    factor(sex) + factor(day) + factor(time), data = tipsTrain)

Odds Ratio:
                   OddsRatio  Std. Err.       z   P&gt;|z|  
total_bill        1.0380e+00 2.8759e-02  1.3463 0.17822  
tip               9.8044e-01 1.7213e-01 -0.1125 0.91040  
size              6.0096e-01 1.6170e-01 -1.8926 0.05841 .
factor(sex)Male   1.0293e+00 3.9342e-01  0.0757 0.93968  
factor(day)Sat    6.0599e-01 4.7004e-01 -0.6458 0.51843  
factor(day)Sun    2.9295e-01 2.4103e-01 -1.4922 0.13564  
factor(day)Thur   2.8693e-08 3.0707e-05 -0.0162 0.98705  
factor(time)Lunch 8.4927e+06 9.0888e+09  0.0149 0.98811  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='st'>"huxtable"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>OR_logit2</span><span class='op'>&lt;-</span><span class='va'>OR_logit</span>
<span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>OR_logit2</span><span class='op'>)</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span><span class='op'>(</span><span class='va'>Partial_atmean_logit</span><span class='op'>)</span>
<span class='va'>OR_logit2</span><span class='op'>$</span><span class='va'>mfxest</span><span class='op'>&lt;-</span><span class='va'>OR_logit2</span><span class='op'>$</span><span class='va'>oddsratio</span>

  <span class='va'>fits</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='st'>"Regular"</span><span class='op'>=</span><span class='va'>regular_logit</span>, <span class='st'>"Odds Ratio"</span><span class='op'>=</span><span class='va'>OR_logit2</span>, 
             <span class='st'>"Partial at the mean"</span><span class='op'>=</span><span class='va'>Partial_atmean_logit</span>, <span class='st'>"Avg Partial"</span><span class='op'>=</span><span class='va'>Avg_Partial_logit</span><span class='op'>)</span>

<span class='fu'>huxtable</span><span class='fu'>::</span><span class='fu'><a href='https://hughjonesd.github.io/huxtable/reference/huxreg.html'>huxreg</a></span><span class='op'>(</span><span class='va'>fits</span>,
      <span class='co'># statistics = c(N = "nobs", R2 = "r.squared"),</span>
       note <span class='op'>=</span> <span class='st'>"Note.This is cool."</span><span class='op'>)</span><span class='op'>%&gt;%</span>
  <span class='fu'>huxtable</span><span class='fu'>::</span><span class='fu'><a href='https://hughjonesd.github.io/huxtable/reference/as_flextable.html'>as_flextable</a></span><span class='op'>(</span><span class='op'>)</span> 
</code></pre>
</div>
<template id="c62e5e33-054e-46bc-b7a7-cd87448352d8"><style>
.tabwid table{
  border-spacing:0px !important;
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style><div class="tabwid"><style>.cl-732205be{}.cl-73172f36{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-73175650{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:6pt;padding-top:6pt;padding-left:6pt;padding-right:6pt;line-height: 1;background-color:transparent;}.cl-73175651{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:6pt;padding-top:6pt;padding-left:6pt;padding-right:6pt;line-height: 1;background-color:transparent;}.cl-73175652{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:6pt;padding-top:6pt;padding-left:6pt;padding-right:6pt;line-height: 1;background-color:transparent;}.cl-73175653{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-7317cbe4{width:76.4pt;background-color:transparent;vertical-align: top;border-bottom: 0.4pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7317cbe5{width:76.4pt;background-color:transparent;vertical-align: top;border-bottom: 0.4pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7317cbe6{width:115.5pt;background-color:transparent;vertical-align: top;border-bottom: 0.4pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7317cbe7{width:113.1pt;background-color:transparent;vertical-align: top;border-bottom: 0.4pt solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7317cbe8{width:108.8pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7317cbe9{width:76.4pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7317cbea{width:108.8pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7317cbeb{width:113.1pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7317cbec{width:76.4pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7317cbed{width:115.5pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7317cbee{width:76.4pt;background-color:transparent;vertical-align: top;border-bottom: 0.4pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7317f2ea{width:76.4pt;background-color:transparent;vertical-align: top;border-bottom: 0.4pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7317f2eb{width:113.1pt;background-color:transparent;vertical-align: top;border-bottom: 0.4pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7317f2ec{width:115.5pt;background-color:transparent;vertical-align: top;border-bottom: 0.4pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7317f2ed{width:76.4pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.4pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7317f2ee{width:76.4pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.4pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7317f2ef{width:115.5pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.4pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7317f2f0{width:113.1pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.4pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7317f2f1{width:76.4pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.4pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7317f2f2{width:113.1pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.4pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7317f2f3{width:115.5pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.4pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7317f2f4{width:108.8pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-73181a04{width:76.4pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.4pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-73181a05{width:76.4pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-73181a06{width:108.8pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-73181a07{width:113.1pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-73181a08{width:115.5pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-73181a09{width:76.4pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-73181a0a{width:115.5pt;background-color:transparent;vertical-align: top;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-73181a0b{width:113.1pt;background-color:transparent;vertical-align: top;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-73181a0c{width:76.4pt;background-color:transparent;vertical-align: top;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-73181a0d{width:76.4pt;background-color:transparent;vertical-align: top;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-73181a0e{width:108.8pt;background-color:transparent;vertical-align: top;border-bottom: 0.8pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-73184114{width:108.8pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-73184115{width:76.4pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-73184116{width:76.4pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-73184117{width:113.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-73184118{width:115.5pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.8pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-73184119{width:113.1pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7318411a{width:108.8pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7318411b{width:76.4pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7318411c{width:76.4pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7318411d{width:115.5pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-7318411e{width:76.4pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-73186824{width:76.4pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-73186825{width:113.1pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-73186826{width:115.5pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-732205be'>
<tbody><tr style="overflow-wrap:break-word;"><td class="cl-7317cbe8"><p class="cl-73175650"><span class="cl-73172f36"></span></p></td><td class="cl-7317cbe5"><p class="cl-73175650"><span class="cl-73172f36">Regular</span></p></td><td class="cl-7317cbe7"><p class="cl-73175650"><span class="cl-73172f36">Odds Ratio</span></p></td><td class="cl-7317cbe6"><p class="cl-73175650"><span class="cl-73172f36">Partial at the mean</span></p></td><td class="cl-7317cbe4"><p class="cl-73175650"><span class="cl-73172f36">Avg Partial</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7317cbea"><p class="cl-73175651"><span class="cl-73172f36">(Intercept)</span></p></td><td class="cl-7317f2ee"><p class="cl-73175652"><span class="cl-73172f36">1.085 </span></p></td><td class="cl-7317f2f0"><p class="cl-73175652"><span class="cl-73172f36">     </span></p></td><td class="cl-7317f2ef"><p class="cl-73175652"><span class="cl-73172f36">     </span></p></td><td class="cl-7317f2ed"><p class="cl-73175652"><span class="cl-73172f36">        </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7317cbea"><p class="cl-73175651"><span class="cl-73172f36"></span></p></td><td class="cl-7317cbec"><p class="cl-73175652"><span class="cl-73172f36">(0.862)</span></p></td><td class="cl-7317cbeb"><p class="cl-73175652"><span class="cl-73172f36">     </span></p></td><td class="cl-7317cbed"><p class="cl-73175652"><span class="cl-73172f36">     </span></p></td><td class="cl-7317cbe9"><p class="cl-73175652"><span class="cl-73172f36">        </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7318411a"><p class="cl-73175651"><span class="cl-73172f36">total_bill</span></p></td><td class="cl-7318411b"><p class="cl-73175652"><span class="cl-73172f36">0.037 </span></p></td><td class="cl-73184119"><p class="cl-73175652"><span class="cl-73172f36">1.038 </span></p></td><td class="cl-7318411d"><p class="cl-73175652"><span class="cl-73172f36">0.009 </span></p></td><td class="cl-7318411c"><p class="cl-73175652"><span class="cl-73172f36">0.008    </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7317cbea"><p class="cl-73175651"><span class="cl-73172f36"></span></p></td><td class="cl-7317cbec"><p class="cl-73175652"><span class="cl-73172f36">(0.028)</span></p></td><td class="cl-7317cbeb"><p class="cl-73175652"><span class="cl-73172f36">(0.029)</span></p></td><td class="cl-7317cbed"><p class="cl-73175652"><span class="cl-73172f36">(0.016)</span></p></td><td class="cl-7317cbe9"><p class="cl-73175652"><span class="cl-73172f36">(0.006)   </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7318411a"><p class="cl-73175651"><span class="cl-73172f36">tip</span></p></td><td class="cl-7318411b"><p class="cl-73175652"><span class="cl-73172f36">-0.020 </span></p></td><td class="cl-73184119"><p class="cl-73175652"><span class="cl-73172f36">0.980 </span></p></td><td class="cl-7318411d"><p class="cl-73175652"><span class="cl-73172f36">-0.005 </span></p></td><td class="cl-7318411c"><p class="cl-73175652"><span class="cl-73172f36">-0.004    </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7317cbea"><p class="cl-73175651"><span class="cl-73172f36"></span></p></td><td class="cl-7317cbec"><p class="cl-73175652"><span class="cl-73172f36">(0.176)</span></p></td><td class="cl-7317cbeb"><p class="cl-73175652"><span class="cl-73172f36">(0.172)</span></p></td><td class="cl-7317cbed"><p class="cl-73175652"><span class="cl-73172f36">(0.044)</span></p></td><td class="cl-7317cbe9"><p class="cl-73175652"><span class="cl-73172f36">(0.037)   </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7317f2f4"><p class="cl-73175651"><span class="cl-73172f36">size</span></p></td><td class="cl-73186824"><p class="cl-73175652"><span class="cl-73172f36">-0.509 </span></p></td><td class="cl-73186825"><p class="cl-73175652"><span class="cl-73172f36">0.601 </span></p></td><td class="cl-73186826"><p class="cl-73175652"><span class="cl-73172f36">-0.127 </span></p></td><td class="cl-7318411e"><p class="cl-73175652"><span class="cl-73172f36">-0.106    </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7317cbea"><p class="cl-73175651"><span class="cl-73172f36"></span></p></td><td class="cl-7317cbec"><p class="cl-73175652"><span class="cl-73172f36">(0.269)</span></p></td><td class="cl-7317cbeb"><p class="cl-73175652"><span class="cl-73172f36">(0.162)</span></p></td><td class="cl-7317cbed"><p class="cl-73175652"><span class="cl-73172f36">(0.211)</span></p></td><td class="cl-7317cbe9"><p class="cl-73175652"><span class="cl-73172f36">(0.059)   </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7317cbea"><p class="cl-73175651"><span class="cl-73172f36">factor(sex)Male</span></p></td><td class="cl-7317cbec"><p class="cl-73175652"><span class="cl-73172f36">0.029 </span></p></td><td class="cl-7317cbeb"><p class="cl-73175652"><span class="cl-73172f36">1.029 </span></p></td><td class="cl-7317cbed"><p class="cl-73175652"><span class="cl-73172f36">0.007 </span></p></td><td class="cl-7317cbe9"><p class="cl-73175652"><span class="cl-73172f36">0.006    </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7317cbea"><p class="cl-73175651"><span class="cl-73172f36"></span></p></td><td class="cl-7317cbec"><p class="cl-73175652"><span class="cl-73172f36">(0.382)</span></p></td><td class="cl-7317cbeb"><p class="cl-73175652"><span class="cl-73172f36">(0.393)</span></p></td><td class="cl-7317cbed"><p class="cl-73175652"><span class="cl-73172f36">(0.096)</span></p></td><td class="cl-7317cbe9"><p class="cl-73175652"><span class="cl-73172f36">(0.079)   </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7317cbea"><p class="cl-73175651"><span class="cl-73172f36">factor(day)Sat</span></p></td><td class="cl-7317cbec"><p class="cl-73175652"><span class="cl-73172f36">-0.501 </span></p></td><td class="cl-7317cbeb"><p class="cl-73175652"><span class="cl-73172f36">0.606 </span></p></td><td class="cl-7317cbed"><p class="cl-73175652"><span class="cl-73172f36">-0.125 </span></p></td><td class="cl-7317cbe9"><p class="cl-73175652"><span class="cl-73172f36">-0.098    </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7317cbea"><p class="cl-73175651"><span class="cl-73172f36"></span></p></td><td class="cl-7317cbec"><p class="cl-73175652"><span class="cl-73172f36">(0.776)</span></p></td><td class="cl-7317cbeb"><p class="cl-73175652"><span class="cl-73172f36">(0.470)</span></p></td><td class="cl-7317cbed"><p class="cl-73175652"><span class="cl-73172f36">(0.192)</span></p></td><td class="cl-7317cbe9"><p class="cl-73175652"><span class="cl-73172f36">(0.140)   </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7317cbea"><p class="cl-73175651"><span class="cl-73172f36">factor(day)Sun</span></p></td><td class="cl-7317cbec"><p class="cl-73175652"><span class="cl-73172f36">-1.228 </span></p></td><td class="cl-7317cbeb"><p class="cl-73175652"><span class="cl-73172f36">0.293 </span></p></td><td class="cl-7317cbed"><p class="cl-73175652"><span class="cl-73172f36">-0.295 </span></p></td><td class="cl-7317cbe9"><p class="cl-73175652"><span class="cl-73172f36">-0.238    </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7317cbea"><p class="cl-73175651"><span class="cl-73172f36"></span></p></td><td class="cl-7317cbec"><p class="cl-73175652"><span class="cl-73172f36">(0.823)</span></p></td><td class="cl-7317cbeb"><p class="cl-73175652"><span class="cl-73172f36">(0.241)</span></p></td><td class="cl-7317cbed"><p class="cl-73175652"><span class="cl-73172f36">(0.963)</span></p></td><td class="cl-7317cbe9"><p class="cl-73175652"><span class="cl-73172f36">(0.136)   </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7317cbea"><p class="cl-73175651"><span class="cl-73172f36">factor(day)Thur</span></p></td><td class="cl-7317cbec"><p class="cl-73175652"><span class="cl-73172f36">-17.367 </span></p></td><td class="cl-7317cbeb"><p class="cl-73175652"><span class="cl-73172f36">0.000 </span></p></td><td class="cl-7317cbed"><p class="cl-73175652"><span class="cl-73172f36">-0.994 </span></p></td><td class="cl-7317cbe9"><p class="cl-73175652"><span class="cl-73172f36">-0.530 ***</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7317cbea"><p class="cl-73175651"><span class="cl-73172f36"></span></p></td><td class="cl-7317cbec"><p class="cl-73175652"><span class="cl-73172f36">(1070.185)</span></p></td><td class="cl-7317cbeb"><p class="cl-73175652"><span class="cl-73172f36">(0.000)</span></p></td><td class="cl-7317cbed"><p class="cl-73175652"><span class="cl-73172f36">(2.027)</span></p></td><td class="cl-7317cbe9"><p class="cl-73175652"><span class="cl-73172f36">(0.039)   </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7317cbea"><p class="cl-73175651"><span class="cl-73172f36">factor(time)Lunch</span></p></td><td class="cl-7317cbec"><p class="cl-73175652"><span class="cl-73172f36">15.955 </span></p></td><td class="cl-7317cbeb"><p class="cl-73175652"><span class="cl-73172f36">8492723.536 </span></p></td><td class="cl-7317cbed"><p class="cl-73175652"><span class="cl-73172f36">0.994 </span></p></td><td class="cl-7317cbe9"><p class="cl-73175652"><span class="cl-73172f36">0.471 ***</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7317cbea"><p class="cl-73175651"><span class="cl-73172f36"></span></p></td><td class="cl-7317f2ea"><p class="cl-73175652"><span class="cl-73172f36">(1070.185)</span></p></td><td class="cl-7317f2eb"><p class="cl-73175652"><span class="cl-73172f36">(9088788914.823)</span></p></td><td class="cl-7317f2ec"><p class="cl-73175652"><span class="cl-73172f36">(1.911)</span></p></td><td class="cl-7317cbee"><p class="cl-73175652"><span class="cl-73172f36">(0.039)   </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-7317f2f4"><p class="cl-73175651"><span class="cl-73172f36">N</span></p></td><td class="cl-7317f2f1"><p class="cl-73175652"><span class="cl-73172f36">148     </span></p></td><td class="cl-7317f2f2"><p class="cl-73175652"><span class="cl-73172f36">0     </span></p></td><td class="cl-7317f2f3"><p class="cl-73175652"><span class="cl-73172f36">0     </span></p></td><td class="cl-73181a04"><p class="cl-73175652"><span class="cl-73172f36">0        </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-73181a06"><p class="cl-73175651"><span class="cl-73172f36">logLik</span></p></td><td class="cl-73181a09"><p class="cl-73175652"><span class="cl-73172f36">-88.646 </span></p></td><td class="cl-73181a07"><p class="cl-73175652"><span class="cl-73172f36">-88.646 </span></p></td><td class="cl-73181a08"><p class="cl-73175652"><span class="cl-73172f36">-88.646 </span></p></td><td class="cl-73181a05"><p class="cl-73175652"><span class="cl-73172f36">-88.646    </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-73181a0e"><p class="cl-73175651"><span class="cl-73172f36">AIC</span></p></td><td class="cl-73181a0c"><p class="cl-73175652"><span class="cl-73172f36">195.293 </span></p></td><td class="cl-73181a0b"><p class="cl-73175652"><span class="cl-73172f36">195.293 </span></p></td><td class="cl-73181a0a"><p class="cl-73175652"><span class="cl-73172f36">195.293 </span></p></td><td class="cl-73181a0d"><p class="cl-73175652"><span class="cl-73172f36">195.293    </span></p></td></tr><tr style="overflow-wrap:break-word;"><td  colspan="5"class="cl-73184114"><p class="cl-73175651"><span class="cl-73172f36">Note.This is cool.</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="5ceb05d2-0682-4a85-af5b-ddfec8a0b048"></div>
<script>
var dest = document.getElementById("5ceb05d2-0682-4a85-af5b-ddfec8a0b048");
var template = document.getElementById("c62e5e33-054e-46bc-b7a7-cd87448352d8");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

</div>
<p>fin</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>This code is borrowed from <a href="https://www.machinegurning.com/rstats/gradient-descent/" class="uri">https://www.machinegurning.com/rstats/gradient-descent/</a><a href="#fnref1" class="footnote-back" role="doc-backlink"></a></p></li>
</ol>
</section>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
